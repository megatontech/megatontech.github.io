(function(n){n.fn.extend({inViewport:function(t){var i=this.filter(function(){return n.inViewport(this,t)});return this.pushStack(i)},mostVisible:function(){var u=this.inViewport(),i=0,t,r;return u.each(function(u,f){t=n(f).data("vpVisibility");t>i&&(i=t,r=f)}),n(r)}});var t={offsetTop:0,offsetBottom:0};n.inViewport=function(i,r){var e=n(i),f,h,c,u,l,o,a,v,y,s;return f=n.extend({},t,r||{}),h=n(window).scrollTop(),c=n(window).height()-f.offsetTop-f.offsetBottom,u=e.height(),l=e.offset(),o=l.top-h-f.offsetTop,a=o+u,v=Math.max(0,Math.min(o-(c-u),u)),y=Math.max(0,Math.min(a,u)),s=(y-v)/u,e.data("vpVisibility",s),s}})(jQuery);
var Asimov=Asimov||{};Asimov.cookie=function(){function i(t,i){var e=n(t),f,r,u;if(e&&i)for(f=e.split("&"),r=0;r<f.length;r++)if(u=f[r].split("="),u[0]&&i.toLowerCase()===u[0].toLowerCase())return u[1];return null}function n(n){for(var f=document.cookie.split(";"),i,u,e,r=0;r<f.length;r++){for(i=f[r];i.charAt(0)==" ";)i=i.substring(1);if(u=i.split("="),e=t(u.shift()),e===n)return t(u.join("="))}return null}function t(n){var t=decodeURIComponent(n.replace("/+/g"," "));return t.indexOf('"')===0&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),t}return{getCookie:n,getCookieKeyValue:i,setCookie:function(n,t,i){var u,r;i?(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toUTCString()):u="";window.document.cookie=n+"="+t+u+"; path=/;"},deleteCookie:function(n){this.setCookie(n,"",-1)}}}();typeof Asimov!="undefined"&&(Asimov.logger=function(){function n(n){self.Asimov.consoleVerbosity>=self.Asimov.verbosityLevels.ERROR&&self.console&&self.console.error&&self.console.error("JSLL: "+n)}function t(n){self.Asimov.consoleVerbosity>=self.Asimov.verbosityLevels.WARNING&&self.console&&self.console.warn&&self.console.warn("JSLL: "+n)}function i(n){self.Asimov.consoleVerbosity>=self.Asimov.verbosityLevels.INFORMATION&&self.console&&self.console.log&&self.console.log("JSLL: "+n)}return{logError:n,logWarning:t,logInformation:i}}());typeof Asimov!="undefined"&&(Asimov.capabilitiesCheck=function(){return function(){return self.jQuery?self.jQuery.fn.jquery<self.Asimov.jQueryMinSupportedVersion?(Asimov.logger.logError("Unable to write event: Minimum version of jQuery "+self.Asimov.jQueryMinSupportedVersion+" required."),Asimov.isAvailable=!1,!1):!self.JSON||!self.JSON.stringify?(Asimov.logger.logError("Unable to write event: the global JSON.stringify method does not exist"),Asimov.isAvailable=!1,!1):void 0:(Asimov.logger.logError("Unable to write event: jQuery is not present"),Asimov.isAvailable=!1,!1)}}());typeof Asimov!="undefined"&&(Asimov.utils={},Asimov.utils.stringifyField=function(n,t){try{return JSON.stringify(t)}catch(u){var i='{"error": "ERROR: could not stringify {0} {1}"}',r=typeof t=="string"?t:"";return i.replace("{0}",n).replace("{1}",r)}},Asimov.utils.getMuidHost=function(n){var t={"microsoft.com":"c1.microsoft.com","xbox.com":"c.xbox.com","live.com":"c.live.com","microsoftstore.com":"c.microsoftstore.com","msn.com":"c.msn.com","windows.com":"c.windows.com"},i="microsoft.com";return n&&t[n]&&(i=n),t[i]},Asimov.utils.isOfCorrectType=function(n,t){if(n=="string")return typeof t=="string"||t instanceof String||t instanceof Date;if(n=="bool")return typeof t=="boolean"||t instanceof Boolean;if(!(typeof t=="number")||t instanceof Number)return!1;if(n=="uint8"){if(t<0||t>255||t%1!=0)return!1}else if(n=="uint16"){if(t<0||t>65535||t%1!=0)return!1}else if(n=="uint32"){if(t<0||t>4294967295||t%1!=0)return!1}else if(n=="uint64"){if(t<0||t>18446744073709551615||t%1!=0)return!1}else if(n=="int8"){if(t<-128||t>127||t%1!=0)return!1}else if(n=="int16"){if(t<-32768||t>32767||t%1!=0)return!1}else if(n=="int32"){if(t<-2147483648||t>2147483647||t%1!=0)return!1}else if(n=="int64"){if(t<-9223372036854775808||t>9223372036854775807||t%1!=0)return!1}else if(n=="float"){if(t<-3402823e32||t>3402823e32)return!1}else if(n=="double"&&(t<Number.MIN_VALUE||t>Number.MAX_VALUE))return!1;return!0});typeof Asimov!="undefined"&&(Asimov.ids=function(){function r(n){t=n}function u(){return n.getCookie("MS0")}function f(){return n.getCookie("MUID")}function e(){return i}function o(){return t?t:$("meta[name='ms.Cv']").attr("content")}function s(n){i=n}function h(){return n.getCookie("Flights")}function c(){return n.getCookie("Treatments")}var i,t,n=Asimov.cookie;return{getSessionId:u,getVisitorId:f,setImpressionGuid:s,getImpressionGuid:e,getCv:o,getFlights:h,getGroups:c,setCVValue:r}}());typeof Asimov!="undefined"&&(Asimov.vortexEvents=function(){function r(i){var r={name:"Ms.Webi.PageView",content:{"Ms.Content.PageView":{uri:i.pageUri,pageName:i.pageName,referrerUri:i.referrerUri,pageTags:i.pageTags,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),contentJsonVer:2,content:i.content,product:i.product,pageType:i.pageType,screenState:i.screenState},"Ms.Webi.PageView":{flightId:i.flightId,utcOffset:i.utcOffset,languages:navigator.userLanguage,slInstalled:i.slInstalled,slEnabled:i.slEnabled,slVersion:i.slVersion,flashInstalled:i.flashInstalled,flashVersion:i.flashVersion,pageLoadTime:i.pageLoadTime,signInStatus:i.signInStatus,cookies:i.cookies,cookieEnabled:i.cookieEnabled,isJs:i.isJs,title:i.title,screenRes:i.screenRes,browserSize:i.browserSize}}};t(r)}function u(i){var r={name:"Ms.Webi.PartialPageView",content:{"Ms.Content.PageView":{uri:i.pageUri,pageName:i.pageName,referrerUri:i.referrerUri,pageTags:i.pageTags,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),contentJsonVer:2,content:i.content},"Ms.Webi.PartialPageView":{}}};t(r)}function f(i){var r={name:"Ms.Webi.ContentView",content:{"Ms.Content.PageView":{uri:i.pageUri,pageName:i.pageName,referrerUri:i.referrerUri,pageTags:i.pageTags,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),contentJsonVer:2,content:i.content,product:i.product,pageType:i.pageType,screenState:i.screenState},"Ms.Webi.ContentView":{flightId:i.flightId,utcOffset:i.utcOffset,languages:navigator.userLanguage,slInstalled:i.slInstalled,slEnabled:i.slEnabled,slVersion:i.slVersion,flashInstalled:i.flashInstalled,flashVersion:i.flashVersion,pageLoadTime:i.pageLoadTime,signInStatus:i.signInStatus,cookies:i.cookies,cookieEnabled:i.cookieEnabled,isJs:i.isJs,title:i.title,screenRes:i.screenRes,browserSize:i.browserSize}}};t(r)}function e(i){var r={name:"Ms.Webi.PageAction",content:{"Ms.Content.PageAction":{uri:i.pageUri,pageName:i.pageName,destUri:i.targetUri,pageTags:i.pageTags,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),contentJsonVer:2,content:i.content,product:i.product,pageType:i.pageType,screenState:i.screenState,actionInputMethod:i.inputMethod,behavior:i.behavior},"Ms.Webi.PageAction":{flightId:i.flightId,timeToAction:i.timeToAction,scrollCount:i.scrollCount,languages:navigator.userLanguage,cookies:i.cookies,cookieEnabled:i.cookieEnabled,isJs:i.isJs,title:i.title,screenRes:i.screenRes,browserSize:i.browserSize,referrerUri:i.referrerUri}}};t(r)}function o(n){var i={};n.type=="CorsDisallowed"?i={name:"Ms.Cll.Javascript.CorsDisallowed",content:{"Ms.Cll.Javascript.CorsDisallowed":{eventName:n.eventName}}}:n.type=="EventTooLong"&&(i={name:"Ms.Cll.Javascript.EventTooLong",content:{"Ms.Cll.Javascript.EventTooLong":{eventName:n.eventName,payloadLength:n.payloadLength}}});t(i)}function s(i,r){var u={name:"Ms.Webi.ClientError",content:{"Ms.Webi.ClientError":{errorInfo:JSON.stringify(i),wasDisplayed:r||!1,customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid()}}};t(u)}function h(i){var r={name:"Ms.Webi.OutgoingRequest",content:{"Ms.Qos.OutgoingServiceRequest":{operationName:i.currentOperationName,targetUri:i.requestUri,latencyMs:i.latencyMs,serviceErrorCode:i.serviceErrorCode||-1,succeeded:i.isSuccess,requestMethod:i.httpMethod,responseContentType:i.contentType,protocolStatusCode:i.httpStatusCode||"",dependencyOperationName:i.operationName,dependencyOperationVersion:i.operationVersion,dependencyName:i.serviceName,dependencyType:i.serviceType||"WebService",responseSizeBytes:i.responseSize},"Ms.Webi.OutgoingRequest":{customSessionGuid:n.getSessionId(),impressionGuid:n.getImpressionGuid(),message:i.errorMessage,retryCount:i.retryCount,customData:i.customData}}};t(r,i.cV)}function t(t,r){var u=r,f;r||(u=n.getCv());Asimov.CorrelationVector.isValid(u)&&(t[Asimov.correlationVectorTag]=u);i&&(t.appId=i);f=n.getGroups();f&&(t.expId=f);Asimov.writeEvent(t)}var i,n=Asimov.ids;return{setAppId:function(n){i=n},sendError:s,sendPageAction:e,sendPageView:r,sendApiComplete:h,sendPartialPageView:u,sendContentView:f,sendJsllEvent:o}}());typeof Asimov!="undefined"&&(Asimov.asimovEventSchemas=function(){function n(){Asimov._registerSchemas([{name:"Ms.Cll.Javascript.CorsDisallowed","Ms.Cll.Javascript.CorsDisallowed":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"}]}}},{name:"Ms.Cll.Javascript.EventTooLong","Ms.Cll.Javascript.EventTooLong":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"},{req:!0,name:"payloadLength",type:"int32"}]}}},{name:"Ms.Cll.Javascript.Error","Ms.Cll.Javascript.Error":{part:"C",def:{fields:[{req:!0,name:"code",type:"int32"},{req:!0,name:"message",type:"string"}]}}},{name:"Ms.Webi.ClientError","Ms.Webi.ClientError":{part:"C",def:{fields:[{req:!0,name:"errorInfo",type:"string"},{name:"wasDisplayed",type:"bool"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"}]}}},{name:"Ms.Webi.OutgoingRequest","Ms.Qos.OutgoingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{req:!0,name:"dependencyOperationName",type:"string"},{name:"dependencyOperationVersion",type:"string"},{req:!0,name:"dependencyName",type:"string"},{name:"dependencyType",type:"string"},{name:"responseSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"Ms.Webi.OutgoingRequest":{part:"C",def:{fields:[{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"message",type:"string"},{name:"retryCount",type:"int32"},{name:"customData",type:"string"}]}}},{name:"Ms.Webi.PageAction","Ms.Content.PageAction":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"destUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"actionInputMethod",type:"int32"},{name:"behavior",type:"int32"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PageAction":{part:"C",def:{fields:[{name:"flightId",type:"string"},{name:"timeToAction",type:"int32"},{name:"scrollCount",type:"int32"},{name:"languages",type:"string"},{name:"cookieEnabled",type:"bool"},{name:"cookies",type:"string"},{name:"screenRes",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"browserSize",type:"string"},{name:"referrerUri",type:"string"}]}}},{name:"Ms.Webi.PageView","Ms.Content.PageView":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PageView":{part:"C",def:{fields:[{name:"flightId",type:"string"},{name:"utcOffset",type:"int32"},{name:"languages",type:"string"},{name:"cookieEnabled",type:"bool"},{name:"slInstalled",type:"bool"},{name:"slEnabled",type:"bool"},{name:"slVersion",type:"string"},{name:"flashInstalled",type:"bool"},{name:"flashVersion",type:"string"},{name:"browserSize",type:"string"},{name:"cookies",type:"string"},{name:"pageLoadTime",type:"int32"},{name:"screenRes",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"signInStatus",type:"int32"}]}}},{name:"Ms.Webi.PartialPageView","Ms.Content.PageView":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PartialPageView":{part:"C",def:{fields:[]}}},{name:"Ms.Webi.ContentView","Ms.Content.PageView":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.ContentView":{part:"C",def:{fields:[{name:"flightId",type:"string"},{name:"utcOffset",type:"int32"},{name:"languages",type:"string"},{name:"cookieEnabled",type:"bool"},{name:"slInstalled",type:"bool"},{name:"slEnabled",type:"bool"},{name:"slVersion",type:"string"},{name:"flashInstalled",type:"bool"},{name:"flashVersion",type:"string"},{name:"browserSize",type:"string"},{name:"cookies",type:"string"},{name:"pageLoadTime",type:"int32"},{name:"screenRes",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"signInStatus",type:"int32"}]}}}])}return{Register:n}}());typeof Asimov!="undefined"&&(Asimov.createGuid=function(){return function(){function n(){return Math.floor(Math.random()*16).toString(16)}var t="xxxxxxxx-xxxx-4xxx-Rxxx-xxxxxxxxxxxx".replace(/x/g,n);return t.replace("R",(8|Math.floor(Math.random()*3)).toString(16))}}());typeof Asimov!="undefined"&&(Asimov.getPageName=function(){return function(){var t=window.location.pathname||"Home",n=t.split("/");return n.length>2&&n[2]!==""?n[2]:"Home"}}());typeof Asimov!="undefined"&&(Asimov.errorHandler=function(){function t(n){var t=window.onerror;window.onerror=function(){t&&t.apply(this,arguments);n.apply(this,arguments)}}function i(){if(arguments){var t={Page:window.location.href,Script:arguments[1]||"",Message:arguments[0]||"",LineNumber:arguments[2]||0,UserAgent:window.navigator.userAgent||"",Platform:window.navigator.platform||""};n.sendError(t,!1)}}function r(){t(i)}var n=Asimov.vortexEvents;return{init:r}}());typeof Asimov!="undefined"&&(Asimov.timespanHandler=function(){function t(t,i){var r=(new Date).getTime();if(i)return r-n[t];n[t]=r}var n={};return{recordTimeSpan:t}}()),function(){function rt(){function i(){var i=Asimov.cookie.getCookie(n);return i&&i.length?t+i:""}var n="MUID",t="t:";return i()}function ot(){var n=window.navigator.userAgent,t=n.indexOf("MSIE ");return t>0?parseInt(n.substring(t+5,n.indexOf(".",t)),10)<9:!1}var t=this,w,b,k,a,o,v;t.Asimov=t.Asimov||{};Asimov._schemas=Asimov._schemas||[];Asimov.uploadUrl="https://web.vortex.data.microsoft.com/collect/v1";Asimov.commonSchemaEnvelopeVersion="2.1";Asimov.javascriptVersion="3.2.0";Asimov.correlationVectorTag="cV";Asimov.correlationVectorHeader="MS-CV";Asimov.experimentIdTag="expId";Asimov.userId=rt();Asimov.getMethodQueryStringParameter="json";Asimov.jQueryMinSupportedVersion="1.11.0";Asimov.isAvailable=!0;Asimov.SignInStatus=-1;var y="JS:",u="appId",nt=[],tt=ot(),it=tt?2083:15e3,n="",f=1,p=5;Asimov.getQueryStringParameters=function(){return n};Asimov.verbosityLevels={NONE:0,ERROR:1,WARNING:2,INFORMATION:3};Object.freeze&&Object.freeze(Asimov.verbosityLevels);Asimov.consoleVerbosity=Asimov.verbosityLevels.NONE;Asimov.capabilitiesCheck();var s=63,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=window.XDomainRequest?"XDomainRequest":"jQuery",r="Unknown",e=t.navigator&&t.navigator.appVersion?t.navigator.appVersion:"";e.indexOf("Win")!=-1?r="Windows":e.indexOf("Mac")!=-1?r="MacOS":e.indexOf("X11")!=-1?r="Unix":e.indexOf("Linux")!=-1&&(r="Linux");w=window.location.hostname;b=function(){for(var t="",n=0;n<16;n++)t+=h.charAt(Math.floor(Math.random()*h.length));return t};this.Asimov.CorrelationVector=function(){var i="",n=i,t=0,r=function(){return n===i?!1:!0},u=function(n){return n.getValue().length+2<=s?!0:!1},f=function(){return n.length+1+(t+1+"").length<=s?!0:!1};this.getValue=function(){return!n||!n.length?"":n.concat(".",t)};this.setValue=function(i){if(this.Asimov.CorrelationVector.isValid(i)){var r=i.lastIndexOf(".");n=i.substr(0,r);t=parseInt(i.substr(r+1),10)}else throw"Cannot set invalid correlation vector value";return n.concat(".",t)};this.init=function(){return n=b(),this.getValue()};this.extend=function(){return r()||this.init(),u(this)&&(n=n.concat(".",t),t=0),this.getValue()};this.increment=function(){return r()||this.init(),f()&&(t=t+1),this.getValue()}};k=new RegExp("^["+h+"]{16}(.[0-9]+)+$");this.Asimov.CorrelationVector.isValid=function(n){return k.test(n)&&n.length<=s};Asimov.cv=new Asimov.CorrelationVector;var ut=function(){return c=="XDomainRequest"&&Asimov.uploadUrl&&Asimov.uploadUrl.indexOf(window.location.protocol)!=0?(Asimov.logger.logError("Unable to write event: CORS requests are not supported cross-protocol in this browser"),!1):!0},d=function(n,t,i){Asimov.logger.logError("Failure sending data to vortex: "+t+"Error: "+i)},l=function(){Asimov.logger.logInformation("Success sending data to vortex")},ft=function(n){Asimov.logger.logError("Failure sending data to vortex using XDomainRequest.  Status code:"+n.status)},i=function(t,i,r){if(i!=undefined&&(r||i.length!=0)){var u=r?"":"'";n.length>0&&(n+="&");n+=t+"="+u+encodeURIComponent(i)+u}},g=function(n,t,r,u){for(var b=u=="C"?"*":"-",h=t.fields,f,e,a,s,v,o,y,p,w,l,c=0;c<h.length;c++){if(f=h[c],e=r[f.name],i(b+f.name,e,f.type!="string"),e===null||e===undefined){if(f.req)return Asimov.logger.logError("Missing required property: "+f.name),!1;continue}if(f.type=="map"){a={};for(s in e){if(!Asimov.utils.isOfCorrectType(f.key,s))return Asimov.logger.logError("A key in the map was of the wrong type: "+f.name),!1;if(!Asimov.utils.isOfCorrectType(f.element,e[s]))return Asimov.logger.logError("A value in the map was of the wrong type: "+f.name),!1;a[s]=e[s]}n[f.name]=a}else if(f.type=="list"||f.type=="set"){if(v=[],Object.prototype.toString.call(e)==="[object Array]")for(o=0;o<e.length;o++){if(e[o]!=null&&!Asimov.utils.isOfCorrectType(f.element,e[o]))return Asimov.logger.logError("The list contains a value of the wrong type: "+f.name),!1;v[o]=e[o]}else return Asimov.logger.logError("The "+f.type+" "+f.name+" was not an array as expected"),!1;n[f.name]=v}else if(f.type=="struct"){if(y={},!g(y,f.def,e,u))return!1;n[f.name]=y}else{if(!Asimov.utils.isOfCorrectType(f.type,e))return Asimov.logger.logError("Property is the wrong type: "+f.name),!1;n[f.name]=e}}for(p in r){for(w=!1,l=0;l<h.length;l++)if(h[l].name==p){w=!0;break}w||Asimov.logger.logError("An unexpected property was found in the event content and dropped: "+p)}return!0},et=function(r){var s=!0,h=[],w,k,g,tt,u,ot,st,a,ht,rt,et,b,v,y,ct,e,o;if(t.jQuery.isArray(r))for(s=!1,w=0;w<r.length;w++)k=Asimov._validateAndTranslateEvent(r[w]),k.success&&h.push(k.event);else g=Asimov._validateAndTranslateEvent(r),g.success&&h.push(g.event);if(h.length!=0){if(s&&n&&(tt=Asimov.uploadUrl.length+n.length,tt+7>it&&(Asimov.logger.logWarning("event is too large to send using get -- using post instead"),u={},u.eventName=r.name,u.payloadLength=tt,u.type="EventTooLong",Asimov.vortexEvents.sendJsllEvent(u),s=!1)),!s&&!ut()){u={};u.eventName=r.name;u.type="CorsDisallowed";Asimov.vortexEvents.sendJsllEvent(u);return}if(s&&n)Asimov.SignInStatus==1?(i("sauth",1,!0),ot=Asimov.uploadUrl+"/t.asm?"+n,f++,st="telframe"+f,a=document.createElement("iframe"),a.id=st,a.hidden="hidden",a.src=ot,document.body.appendChild(a),f>p&&(ht="telframe"+(f-p),$("#"+ht).remove())):(rt=Asimov.uploadUrl+"/t.gif?"+n,document.images?(et=new Image,et.src=rt,nt.push(et)):(b=document.createElement("IMG"),b.style.display="none",b.src=rt,document.body.appendChild(b)));else{for(v="",y=0;y<h.length;y++)y>0&&(v+="\n"),v+=t.JSON.stringify(h[y]);c==="jQuery"?(ct={accepts:{text:"application/json"},url:Asimov.uploadUrl,type:"post",dataType:"text",data:v,crossDomain:!0,headers:{"Content-Type":"application/x-json-stream"}},e=window.jQuery.ajax(ct),e.fail?e.fail(d):e.error(d),e.done?e.done(l):e.success(l)):c==="XDomainRequest"?(o=new XDomainRequest,o.onload=l,o.onerror=function(){ft(o)},o.open("post",Asimov.uploadUrl),o.send(v)):Asimov.logger.logError("No event is sent.")}}};for(Asimov.writeEvent=function(n){et(n)},Asimov._validateAndTranslateEvent=function(t){function o(n,t){s[n]=t;i(n,t)}var s={},c={},l={},f={event:s,success:!1},h,e,a,v,p,b,k,d,nt;if(n="",!t)return Asimov.logger.logError("Unable to write null event"),f;if(!t.name)return Asimov.logger.logError("Unable to write event with missing name"),f;if(!Asimov._schemas.hasOwnProperty(t.name))return Asimov.logger.logError("Unable to write event: a schema for the event named {"+t.name+"} does not exist"),f;if(!t.content)return Asimov.logger.logError("Unable to write event: the event is missing content"),f;o("ver",Asimov.commonSchemaEnvelopeVersion);o("name",t.name);o("time",(new Date).toISOString());o("os",r);h=Asimov._schemas[t.name];for(e in h)if(e!=="name"){if(a=h[e],!t.content.hasOwnProperty(e))return Asimov.logger.logError("Unable to write event: missing expected part: "+e),f;if(a.part=="C"?v=l:(v={},l.baseData=v,l.baseType=e,i("*baseType",e)),!g(v,a.def,t.content[e],a.part))return f}for(p in t.content)h[p]&&h[p].part||Asimov.logger.logError("An unexpected property was found in the event content and dropped: "+p);if(s.data=l,s.tags={},t.hasOwnProperty(Asimov.correlationVectorTag))if(Asimov.CorrelationVector.isValid(t[Asimov.correlationVectorTag]))o("cV",t[Asimov.correlationVectorTag]);else return Asimov.logger.logError("Unable to write event: The correlation vector value is invalid: "+t[Asimov.correlationVectorTag]),f;else o("cV",Asimov.cv.getValue());if(t.hasOwnProperty(Asimov.experimentIdTag))if(Asimov.utils.isOfCorrectType("string",t[Asimov.experimentIdTag]))b={},k=t[Asimov.experimentIdTag],b[Asimov.experimentIdTag]=k,c.app=b,i("ext-app-"+Asimov.experimentIdTag,k);else return Asimov.logger.logError("Unable to write event: The supplied experiment id is invalid: "+t[Asimov.experimentIdTag]),f;return t.hasOwnProperty(u)?Asimov.utils.isOfCorrectType("string",t[u])?o("appId",y+t[u]):Asimov.logger.logError("Unable to write event: The supplied appId is invalid: "+t[u]):o("appId",y+w),d={},d.libVer=Asimov.javascriptVersion,c.javascript=d,i("ext-javascript-libVer",Asimov.javascriptVersion),Asimov.userId!=null&&(Asimov.utils.isOfCorrectType("string",Asimov.userId)?(nt={},nt.localId=Asimov.userId,c.user=nt,i("ext-user-localId",Asimov.userId)):Asimov.logger.logError("ignoring the userid value because it is invalid: "+Asimov.userId)),s.ext=c,f.success=!0,f},Asimov._registerSchemas=function(n){for(var t=0;t<n.length;t++)Asimov._schemas[n[t].name]=n[t]},Asimov.console=window.console||{},Asimov.console.fallback=Asimov.console.log||function(){},a=["log","info","warn","error","trace"],o=0;o<a.length;o++)v=a[o],Asimov.console[v]||(Asimov.console[v]=Asimov.console.fallback);Date.prototype.toISOString||function(){function n(n){var t=String(n);return t.length===1&&(t="0"+t),t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+n(this.getUTCMonth()+1)+"-"+n(this.getUTCDate())+"T"+n(this.getUTCHours())+":"+n(this.getUTCMinutes())+":"+n(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}()}();Asimov=window.Asimov;typeof Asimov!="undefined"&&(Asimov.clickstreamTracker=function(){function at(t){Asimov.isAvailable&&(ct.Register(),u.setImpressionGuid(b()),h&&(Asimov.SignInStatus==1?$(document).ready(function(){e()}):e()),y=n.getMuidHost(t),v&&lt.init(),$(function(){a&&vt();l&&$(document).click(yt);c&&(document.readyState==="complete"?nt():$(window).load(nt))}))}function vt(){if(!(window.location.host.indexOf(ht)<0)){var t=window.location.protocol+"//"+y+"/c.gif?DI=4050&did=1&t=",n=document.createElement("IMG");n.style.display="none";n.src=t;document.body.appendChild(n)}}function yt(n){for(var f={A:!0,BUTTON:!0,AREA:!0,INPUT:!0},i=n||window.event,t=i.srcElement||i.target,r,u;t&&t.tagName;)if(f[t.tagName.toUpperCase()]){r=t.tagName.toUpperCase()=="INPUT"?d[t.type.toUpperCase()]:!0;r&&(u=$(t).attr("data-bi-dnt"),u===undefined&&o(t));break}else{t=t.parentElement||t.parentNode;continue}}function g(r,e,o){var s={},c,l,h,v,a;if(s.referrerUri=t,s.cookieEnabled=ot(),s.browserSize=et(),s.screenRes=window.screen&&screen.width+"x"+screen.height,s.pageUri=i,s.cookies=ut(),s.flightId=u.getFlights(),s.signInStatus=Asimov.signInStatus,s.isJs=!0,s.title=document.title,o&&(s.content=it()),p&&(c=ui(),s.slInstalled=c.installed||!1,s.slEnabled=c.enabled||!1,s.slVersion=c.version||"",l=ri(),s.flashInstalled=l.installed||!1,s.flashVersion=l.version||""),s.pageName=f(),h={},o&&window.performance&&window.performance.timing){if(w===!0)try{v=window.performance.getEntries().filter(function(n){return n.initiatorType==="script"||n.initiatorType==="link"});h.AssetPerformance=n.stringifyField("AssetPerformance",v)}catch(y){}h.timing=n.stringifyField("timing",window.performance.timing);window.performance.timing.domComplete>0&&(s.pageLoadTime=window.performance.timing.domComplete-window.performance.timing.fetchStart)}if(h.metaTags=ft(),r)for(a in r)h[a]=r[a];return s.pageTags=n.stringifyField("pageTags",h),e&&(e.pageLoadTime&&(s.pageLoadTime=e.pageLoadTime),e.referrerUri&&(s.referrerUri=e.referrerUri),e.pageUri&&(s.pageUri=e.pageUri),e.pageName&&(s.pageName=e.pageName)),s}function e(n,t){var i=g(n,t,!1);r.sendPageView(i)}function pt(u,e,o){var s={};s.referrerUri=t;s.pageUri=i;s.content=it(u);s.pageLoadTime=e;s.pageName=f();o&&(s.pageTags=n.stringifyField("pageTags",o));r.sendPartialPageView(s)}function nt(){tt()}function tt(n,t){var i=g(n,t,!0);r.sendContentView(i)}function wt(n,t){o(null,t,n)}function bt(n,t){o(n,t,null)}function o(e,o,s){var h={},c={};h.timeToAction=kt();e?(h.targetUri=ti(e),h.content=dt(e),c=ii(e)):s&&(h.targetUri=s.targetUri,h.content=ni(s));c.metaTags=ft();o&&(c=$.extend(c,o));h.pageTags=n.stringifyField("pageTags",c);h.pageUri=i;h.referrerUri=t;h.cookieEnabled=ot();h.browserSize=et();h.screenRes=window.screen&&screen.width+"x"+screen.height;h.pageName=f();h.cookies=ut();h.flightId=u.getFlights();h.isJs=!0;h.title=document.title;r.sendPageAction(h)}function kt(){var t=(new Date).getTime(),n;return window.performance&&window.performance.timing&&(n=window.performance.timing.domComplete,n!==0)?t-n:-1}function it(n){var e=[],u,i,r,f,t,o;for(n?(i=$("#"+n),i=i&&i.length===1&&i[0],u=$("[data-bi-slot]",$(i)).inViewport()):u=$("[data-bi-slot]").inViewport(),f=0;f<u.length;f++)t=$(u[f]),r=rt(t),o={areaName:r.areaName,slotNumber:t.attr("data-bi-slot"),templateName:r.templateName,contentId:t.attr("data-bi-id")||t.attr("id"),contentName:t.attr("data-bi-name")||t.attr("name")||t.attr("alt")||"",contentSource:t.attr("data-bi-source")||r.contentSource,product:t.attr("data-bi-product")||r.product,contentType:t.attr("data-bi-type")||r.type},e.push(o);return s(e)}function dt(n){if(!n)return"";var i=rt(n),u=[],r=$(n).closest("[data-bi-name]"),t=r&&r.length===1?$(r[0]):$(n),f={areaName:i.areaName,slotNumber:t.attr("data-bi-slot"),templateName:i.templateName,contentId:t.attr("data-bi-id")||n.id||"",contentName:t.attr("data-bi-name")||gt(n)||"",contentSource:t.attr("data-bi-source")||i.contentSource,product:t.attr("data-bi-product")||i.product,contentType:t.attr("data-bi-type")||i.type};return u.push(f),s(u)}function gt(n){if(st(n)||!n.tagName)return"";switch(n.tagName){case"A":return document.all?n.innerText||n.innerHTML:n.text||n.innerHTML;case"IMG":case"AREA":return n.alt;default:return n.value||n.name||n.alt||n.innerText||n.id}}function rt(n){var i=$(n).closest("[data-bi-area]"),t=i&&i.length===1?$(i[0]):$(n);return{areaName:t.attr("data-bi-area"),templateName:t.attr("data-bi-view"),contentSource:t.attr("data-bi-source"),product:t.attr("data-bi-product"),type:t.attr("data-bi-type")}}function ni(n){var t=[],i={areaName:n.areaName,slotNumber:n.slotNumber,templateName:n.templateName,contentId:n.contentId,contentName:n.name,contentSource:n.contentSource,product:n.product};return t.push(i),s(t)}function s(n){return JSON.stringify(n)}function ut(){var u="",f=["MC1","MSFPC"],i,n,t,r;Asimov.SignInStatus==0&&f.push("ANON");i={};n=f;try{try{window.varCustomerCookies&&window.varCustomerCookies.length>0&&(n=n.concat(window.varCustomerCookies))}catch(e){}for(t in n)i.hasOwnProperty(n[t])||(i[n[t]]="",r=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(n[t]).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")),r!=""&&(u+=n[t]+"="+r+";"))}catch(e){}return u}function ti(n){var t="",i,r;switch(n.tagName){case"A":case"AREA":t=n.href||"";break;case"IMG":t=ei(r);break;case"INPUT":i=n.type;r=window.event;i&&d[i.toUpperCase()]&&(t=n.form?n.form.action||window.location.pathname:window.location.pathname)}return t}function ii(n){for(var r={},t,i;n;)if(!st(n)){for(t in n.attributes)t&&n.attributes[t]&&(i=n.attributes[t].name,i&&i.toLowerCase().indexOf("ms.")==0&&(r[i]=n.attributes[t].value));n=n.parentElement||n.parentNode}return r}function ri(){var n={},i,r,t,u;if(navigator.plugins["Shockwave Flash"])n.installed=!0,i=navigator.plugins["Shockwave Flash"],n.version=i.description.split(" ")[2];else if(navigator.userAgent.indexOf("MSIE")!=-1)for(r=(new Date).getFullYear()-1992,t=r;t>0;t--)try{u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+t);n.installed=!0;n.version=t+".0";break}catch(f){}return n}function ui(){var n={},u,t,i,r;window.Silverlight!=undefined&&(n.enabled=!0);try{navigator.plugins["Silverlight Plug-In"]?(u=navigator.plugins["Silverlight Plug-In"],n.installed=!0,t=u.description,t&&(i=t.split("."),t=i[0]+"."+i[1],n.version=t)):navigator.userAgent.indexOf("MSIE")!=-1&&(r=new ActiveXObject("AgControl.AgControl"),r&&(n.installed=!0,n.version=fi(r)))}catch(f){}return n}function ft(){for(var r={},n,u,i=$("meta"),t=0;t<i.length;t++)n=i[t],n.name&&(u=n.name.toLowerCase(),u.indexOf("ms.")==0&&(r[n.name]=n.content));return r}function et(){var n="";return document.body&&document.body.clientWidth?n=document.body.clientWidth+"x"+document.body.clientHeight:document.documentElement&&document.documentElement.clientWidth?n=document.documentElement.clientWidth+"x"+document.documentElement.clientHeight:window.innerWidth&&(n=window.innerWidth+"x"+window.innerHeight),n}function ot(){if(navigator.cookieEnabled)return navigator.cookieEnabled;var n="MC0",t=k.getCookie(n);return t||(document.cookie=n+"="+b(),t=k.getCookie(n)),t?!0:!1}function fi(n){for(var t="",u=(new Date).getYear()-2004,r,i=u;i>0;i--)for(r=9;r>=0;r--)if(t=i+"."+r,n.IsVersionSupported(t))return t;return t}function ei(n){var i=n,t;if(i&&(t=$(i).closest("A"),t.length===1)){if(t[0].href)return t[0].href;if(t[0].src)return t[0].src}return""}function st(n){if(!n||!n.attributes)return!1;try{var t=n.getAttribute("data-dc");return t!=null&&t!=undefined?t.toLowerCase()=="pii"?1:0:0}catch(i){return 0}}var h=!0,c=!0,l=!0,a=!0,v=!0,y,ht,t=document.referrer,i=window.location.href,p=!1,w=!1,ct=Asimov.asimovEventSchemas,b=Asimov.createGuid,k=Asimov.cookie,lt=Asimov.errorHandler,u=Asimov.ids,f=Asimov.getPageName,r=Asimov.vortexEvents,n=Asimov.utils,d={BUTTON:!0,CHECKBOX:!0,RADIO:!0,RESET:!0,SUBMIT:!0};return{init:at,capturePageView:e,captureContentView:tt,capturePartialView:pt,capturePageAction:bt,captureContentPageAction:wt,disableAutoPageView:function(){h=!1},disableAutoContentView:function(){c=!1},disableAutoClickTracking:function(){l=!1},disableMuidSync:function(){a=!1},disableJavascriptErrorTracker:function(){v=!1},enableCaptureAddInsInfo:function(){p=!0},enableCaptureAssetsPerfInfo:function(){w=!0},setReferrer:function(n){n!=null&&(t=n)},getReferer:function(){return t},setRequestUri:function(n){n&&(i=n)},getRequestUri:function(){return i},setSignInStatus:function(n){Asimov.SignInStatus=n===!0?1:0},setAppId:function(n){n&&r.setAppId(n)}}}());typeof Asimov!="undefined"&&(Asimov.service=function(){var i=Asimov.vortexEvents,t=Asimov.timespanHandler,n=function(n){function s(t,e,s){var h=t.getResponseHeader("Content-Length"),c={serviceName:n.serviceName,operationName:o,operationVersion:n.version&&n.version.toString(),httpStatusCode:t.status&&t.status.toString(),isSuccess:e,serviceErrorCode:!e&&t.responseJSON&&t.responseJSON.code?t.responseJSON.code:-1,requestUri:r.url,httpMethod:r.type,contentType:r.dataType,latencyMs:s,cV:t.getResponseHeader("MS-CV")||u["MS-CV"],retryCount:f,responseSize:h&&parseInt(h),errorMessage:t.errorThrown,currentOperationName:n.currentOperationName||window.location.href};i.sendApiComplete(c)}function h(){var n=o+"_Retry_"+f;return t.recordTimeSpan(n),$.ajax(r).then(function(i,r,u){var f=t.recordTimeSpan(n,!0);return s(u,!0,f),u},function(i,r){var e=t.recordTimeSpan(n,!0),u;return s(i,!1,e),u=$.Deferred(),l>f&&(i.status===0||i.status>=500&&i.status<600)?(f++,setTimeout(function(){h().done(u.resolve).fail(u.reject)},50)):u.reject(i,r),u.promise()})}$.support.cors=!0;var u=n.additionalHeaders||{},e=n.body,c=e?JSON.stringify(e):n.data||undefined,l=n.maxRetry||0,f=0,a=$.noop,o=n.operationName||n.url,v=n.errorFormatter||function(n){return n},r={url:n.url,type:n.method,data:c,crossDomain:!0,headers:{},success:n.success,error:n.error,jsonp:n.jsonp,jsonpCallback:n.jsonpCallback,cache:n.cache,beforeSend:function(t){if(a(t),n.contractVersion&&t.setRequestHeader("MS-Contract-Version",n.contractVersion),u)for(var i in u)t.setRequestHeader(i,u[i])},defaultError:n.defaultError};return n.dataType!=="auto"&&(r.dataType=n.dataType||"json"),n.noCacheBusting||(r.cache=!1),n.contentType&&(r.headers["Content-Type"]=n.contentType),n.accept&&(r.headers.Accept=n.accept),h().then(function(n){return n},function(t){return v(t,n)})};return{post:function(t){return n($.extend({},t,{method:"POST"}))},get:function(t){return n($.extend({maxRetry:1},t,{method:"GET"}))},put:function(t){return n($.extend({},t,{method:"PUT"}))},del:function(t){return n($.extend({},t,{method:"DELETE"}))}}}());typeof define=="function"&&define.amd&&window.Asimov&&(!require.specified("jquery")&&window.jQuery&&(define.amd.jQuery=!1,define("jquery",[],function(){return window.jQuery})),define("Asimov",[],function(){return window.Asimov}),define("asimovEventSchemas",[],function(){return window.Asimov.asimovEventSchemas}),define("cookie",[],function(){return window.Asimov.cookie}),define("createGuid",[],function(){return window.Asimov.createGuid}),define("ids",[],function(){return window.Asimov.ids}),define("pageName",[],function(){return window.Asimov.getPageName}),define("vortexEvents",[],function(){return window.Asimov.vortexEvents}),define("windowErrorHandler",[],function(){return window.Asimov.errorHandler}),define("timeSpanHandler",[],function(){return window.Asimov.timespanHandler}),define("clickstreamTracker",[],function(){return window.Asimov.clickstreamTracker}))