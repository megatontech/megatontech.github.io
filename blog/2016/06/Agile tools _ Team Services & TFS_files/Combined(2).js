(function(){var headerModule=function($){function init(){$("#ux-header .navL1 > li.toggle > a").each(function(){$(this).click(function(e){window.vscs.vscom.header.addActiveClassForL1($(this));e.stopPropagation()})});$("#ux-header .navL2 > li.toggle > a").each(function(){$(this).bind("click",function(e){window.vscs.vscom.header.addActiveClassForL2($(this));e.stopPropagation()});$(this).bind("focus mouseover",function(e){window.vscs.vscom.header.isElementsMoved||(window.vscs.vscom.header.addActiveClassForL2($(this),!0),e.stopPropagation())})});$("#ux-header .navL2 > li:not(.toggle) > a").each(function(){$(this).bind("focus mouseover",function(e){window.vscs.vscom.header.isElementsMoved||(window.vscs.vscom.header.closeAllL3(!0),e.stopPropagation())})});$("html, body").bind("click",function(){window.vscs.vscom.header.isElementsMoved||(window.vscs.vscom.header.closeAllL2(),window.vscs.vscom.header.closeAllL3())});$("#ux-header").append('<div id="overlayMaskHeader"/>');$(document.body.appendChild($('<div id="overlayMask"/>')[0]));$mask=$("#overlayMaskHeader, #overlayMask");$mask.on("touchstart",function(){window.vscs.vscom.header.bodyScrollTop=$("body")[0].srollTop});$mask.on("touchmove",function(){Math.abs(window.vscs.vscom.header.bodyScrollTop-$("body")[0].srollTop)>=10&&(window.vscs.vscom.header.touchScroll=!0)});$mask.click(function(){window.vscs.vscom.header.touchScroll||window.vscs.vscom.header.showMenu(!1);window.vscs.vscom.header.touchScrolltouchScroll=!1});$("#ux-header #grip").click(function(){$("#ux-header #drawer").show();window.vscs.vscom.header.showMenu(window.vscs.vscom.header.openMenu)});$("#ux-header div.upperBand").click(function(event){window.vscs.vscom.header.deviceType!=window.vscs.vscom.header.deviceTypes.desktop&&window.vscs.vscom.header.toggleMiddleBar()});window.vscs.vscom.header.isSignedIn()&&$("#ux-header div.middleBand").addClass("signedIn");$(window).resize(function(){window.vscs.vscom.header.windowWidth!=$(window).width()&&(window.vscs.vscom.header.resize(),window.vscs.vscom.header.windowWidth=$(window).width())});window.vscs.vscom.header.resize();window.vscs.vscom.header.windowWidth=$(window).width()}window.vscs=window.vscs||{};window.vscs.vscom=window.vscs.vscom||{};window.vscs.vscom.header=window.vscs.vscom.header||{};window.vscs.vscom.header.windowWidth=0;window.vscs.vscom.header.isElementsMoved=!1;window.vscs.vscom.header.touchScroll=!1;window.vscs.vscom.header.openMenu=!0;window.vscs.vscom.header.bodyScrollTop=0;window.vscs.vscom.header.deviceTypes={desktop:"desktop",tablet:"tablet",mobile:"mobile"};window.vscs.vscom.header.deviceType=window.vscs.vscom.header.deviceTypes.desktop;window.vscs.vscom.header.clearHeight=function($object){$object.css("height","")};window.vscs.vscom.header.addActiveClassForL1=function($this){var selfActive=$this.parent().hasClass("active");window.vscs.vscom.header.closeAllL3();window.vscs.vscom.header.closeAllL2();window.vscs.vscom.header.clearHeight($this.next());selfActive||(window.vscs.vscom.header.isElementsMoved?$this.next().animate({height:"toggle"},200,"swing",function(){$(this).parent().removeClass("inactive").addClass("active")}):($this.parent().removeClass("inactive").addClass("active"),$this.next().animate({height:"toggle"},66,"swing")))};window.vscs.vscom.header.adjustCssForLeftNav=function(){var $fixLeftNavParameters=$("#content input#fixLeftNavParameters"),headerHeight=$("#ux-header").height(),$tocNavigation_Breadcrumbs_WithDropDowns=$("#TocNavigation_Breadcrumbs_WithDropDowns"),params;$tocNavigation_Breadcrumbs_WithDropDowns.length==1&&(headerHeight+=$tocNavigation_Breadcrumbs_WithDropDowns.height());$fixLeftNavParameters.length==1&&(params=$fixLeftNavParameters.val().split(","),params!=null&&params.length>0&&(params[0]=headerHeight+40,$fixLeftNavParameters.val(params.join())))};window.vscs.vscom.header.adjustCssForCurrentBookmark=function(){var headerHeight=$("#ux-header").height(),marginTop=headerHeight,paddingTop=headerHeight,$tocNavigation_Breadcrumbs_WithDropDowns=$("#TocNavigation_Breadcrumbs_WithDropDowns"),breadcrumbHeight,$currentBookmark;$tocNavigation_Breadcrumbs_WithDropDowns.length==1&&(breadcrumbHeight=$tocNavigation_Breadcrumbs_WithDropDowns.outerHeight(),marginTop+=breadcrumbHeight-20,paddingTop+=breadcrumbHeight);$currentBookmark=$(window.location.hash);$currentBookmark.length==1&&($currentBookmark.css("margin-top","-"+marginTop+"px"),$currentBookmark.css("padding-top",paddingTop+"px"))};window.vscs.vscom.header.tuneHeight=function($object1,$object2){window.vscs.vscom.header.clearHeight($object1);window.vscs.vscom.header.clearHeight($object2);var minHeight=Math.max($object1.height(),$object2.height());$object1.css("height",minHeight);$object2.css("height",minHeight)};window.vscs.vscom.header.addActiveClassForL2=function($this,isHover){var selfActive=$this.parent().hasClass("active"),visibleL3;if(selfActive){window.vscs.vscom.header.isElementsMoved&&(window.vscs.vscom.header.clearHeight($this.next()),window.vscs.vscom.header.closeAllL3());return}visibleL3=window.vscs.vscom.header.closeAllL3(!isHover);window.vscs.vscom.header.isElementsMoved?(window.vscs.vscom.header.clearHeight($this.next()),$this.next().animate({height:"toggle"},200,"swing",function(){$(this).parent().removeClass("inactive").addClass("active")})):($this.parent().removeClass("inactive").addClass("active"),visibleL3?$this.next().css("display","block"):$this.next().animate({width:"toggle"},200,"swing"),window.vscs.vscom.header.tuneHeight($this.next(),$this.parent().parent()))};window.vscs.vscom.header.closeAllL2=function(){var $l2=$("#ux-header .navL1 > li.active"),subSelector=".navL2";window.vscs.vscom.header.isElementsMoved?$l2.find(subSelector).animate({height:"toggle"},200,"swing",function(){$(this).parent().removeClass("active").addClass("inactive")}):($l2.removeClass("active").addClass("inactive"),$("#ux-header "+subSelector).css("display","none"))};window.vscs.vscom.header.closeAllL3=function(toggleAnimationEnabled){var $l3=$("#ux-header .navL2 > li.active"),subSelector=".navL3",$l3Menu=$l3.find(subSelector),visibleL3=$l3.length;return window.vscs.vscom.header.isElementsMoved?$l3Menu.animate({height:"toggle"},200,"swing",function(){$(this).parent().removeClass("active").addClass("inactive")}):($l3.removeClass("active").addClass("inactive"),toggleAnimationEnabled?$l3Menu.animate({width:"toggle"},200,"swing",function(){window.vscs.vscom.header.clearHeight($l3.parent());window.vscs.vscom.header.clearHeight($l3Menu)}):$("#ux-header "+subSelector).css("display","none")),visibleL3>0};window.vscs.vscom.header.drawerShouldMove=function(){return $("#ux-header #grip:visible").length>0};window.vscs.vscom.header.isMobile=function(){return $("#ux-header span#isMobile:visible").length>0};window.vscs.vscom.header.isSignedIn=function(){return $("#ux-header .createProfileLink").length>0};window.vscs.vscom.header.moveElements=function(restoreOriginalPosition){restoreOriginalPosition?($("#ux-header #drawer").appendTo($("#ux-header #desktopTocContainer")),$("#ux-header #Fragment_SubscriptionsLink").appendTo($("#ux-header div.upperBandContent div.right")),$("#ux-header #signIn").appendTo($("#ux-header div.upperBandContent div.right")),$("#ux-header #Fragment_SearchBox").appendTo($("#ux-header div.upperBandContent div.right"))):($("#ux-header #drawer").appendTo($("#ux-header .lowerBand")),$("#ux-header #Fragment_SubscriptionsLink").appendTo($("#ux-header div.middleBandContent div.left")),$("#ux-header #signIn").appendTo($("#ux-header div.middleBandContent div.right")),$("#ux-header #Fragment_SearchBox").appendTo($("#ux-header div.middleBandContent div.right")));window.vscs.vscom.header.isElementsMoved=!restoreOriginalPosition};window.vscs.vscom.header.showMenu=function(show){$("div#drawer>div.toc").toggleClass("open");show?($("#overlayMaskHeader, #overlayMask").show(),$("#overlayMaskHeader, #overlayMask").height($(document).height())):$("#overlayMaskHeader, #overlayMask").hide();window.vscs.vscom.header.openMenu=!show};window.vscs.vscom.header.toggleMiddleBar=function(){var $middleBar=$("#ux-header div.middleBand");$("#ux-header div.middleBand:visible").length>0?$middleBar.fadeOut(0):$middleBar.fadeIn(0)};window.vscs.vscom.header.closeMiddleBar=function(){$("#ux-header div.middleBand").hide()};window.vscs.vscom.header.resize=function(){window.vscs.vscom.header.openMenu||window.vscs.vscom.header.showMenu(!1);window.vscs.vscom.header.isElementsMoved!=window.vscs.vscom.header.drawerShouldMove()&&(window.vscs.vscom.header.isElementsMoved?$("#ux-header #drawer").css("display","inline-block"):(window.vscs.vscom.header.closeAllL3(),window.vscs.vscom.header.closeAllL2(),window.vscs.vscom.header.closeMiddleBar(),$("#ux-header #drawer").css("display","none")),window.vscs.vscom.header.moveElements(window.vscs.vscom.header.isElementsMoved));window.vscs.vscom.header.deviceType=window.vscs.vscom.header.isElementsMoved?window.vscs.vscom.header.isMobile()?window.vscs.vscom.header.deviceTypes.mobile:window.vscs.vscom.header.deviceTypes.tablet:window.vscs.vscom.header.deviceTypes.desktop;$("#ux-header").attr("data-device-type",window.vscs.vscom.header.deviceType);window.vscs.vscom.header.isElementsMoved||(window.vscs.vscom.header.closeAllL3(),window.vscs.vscom.header.closeAllL2(),window.vscs.vscom.header.closeMiddleBar())};$(document).ready(function(){init()})};typeof define=="function"&&window.mtpsAmd?define("header",["jquery"],function($){return headerModule($)}):headerModule($)})();;
(function(){function generateMobileFunctionMenu(){if($("#ux-header").length>0?$("#mobileMenu").attr("data-offset-top",$("#ux-header").outerHeight()+$("#ux-banner").outerHeight()):$("#uhf-header-wrapper").length>0&&$("#mobileMenu").attr("data-offset-top",$("#uhf-header-wrapper").outerHeight()+$("#ux-banner").outerHeight()),$("#navigationButtons").clone().appendTo($("#functionDropdownMenu")),$("#functionDropdownMenu #currentOPBranch").length>0&&($result=$("<div/>").attr("id","mobileBranchs"),$("#functionDropdownMenu #currentOPBranch > option").each(function(){$newDiv=$("<div/>").append(this.value);$("#functionDropdownMenu #currentOPBranch").val()==this.value&&$newDiv.addClass("currentBranch");$result.append($newDiv)}),$result.appendTo($("#mobileBranchSelector"))),$("#mobileBranchs .currentBranch").length>0&&$("#mobileBranchs").prepend($("#mobileBranchs .currentBranch")),$("#functionDropdownMenu #currentOPBranch").length>0){var selectedBranch=$("#functionDropdownMenu #currentOPBranch").val();$("#functionDropdownMenu #currentOPBranch").replaceWith(selectedBranch)}$("#functionDropdownMenu #socials").length>0&&($("#functionDropdownMenu #socials").show(),$("#functionDropdownMenu #socials").appendTo($("#mobileSocialShare")));$("#functionDropdownMenu #opBranchList").length>0&&$("#functionDropdownMenu #opBranchList").css("margin-bottom",0);$("#tocNav .tocData").length>0&&$("#tocNav .tocData").children().clone().appendTo($("#tocDropdownMenu"))}function generateTabletFunctionMenu(){if($("#breadcrumbTablet").length>0)$target=$("#breadcrumbTablet");else if($("#tabletContainerWithoutBreadcrumbs").length>0)$target=$("#tabletContainerWithoutBreadcrumbs");else return;$("#navigationButtons").clone().appendTo($target)}var OpenPublishingMobileMenuModule=function($,utilities){function init(){generateTabletFunctionMenu();generateMobileFunctionMenu();$("#functionDropdownMenuButton").click(function(e){$("#functionDropdownMenuButton").toggleClass("expanded");$("#functionDropdownMenu").toggle();e.stopPropagation()});$("body").not("#functionDropdownMenuButton").click(function(){$("#functionDropdownMenuButton").length>0&&$("#functionDropdownMenuButton").hasClass("expanded")&&($("#functionDropdownMenuButton").removeClass("expanded"),$("#functionDropdownMenu").hide())});$("#tocDropdownMenuButton").click(function(){$("#tocDropdownMenuButton").toggleClass("expanded");$("#tocDropdownMenu").toggle();$("#tocDropdownMenuButton").hasClass("expanded")&&$("#tocDropdownMenu").css("height",$(window).height()-$("#tocDropdownMenu").position().top)});$("#tocDropdownMenu").click(function(e){e.stopPropagation()});$("#functionDropdownMenu #isdShare").length>0&&$("#functionDropdownMenu #isdShare").click(function(){$("#mobileSocialShare #socials").length>0&&$("#mobileSocialShareModal").modal("show")});$("#functionDropdownMenu #opBranchList").length>0&&$("#functionDropdownMenu #opBranchList").click(function(){$("#mobileBranchSelectorModal").modal("show")});$("#mobileBranchs > div").length>0&&$("#mobileBranchs > div").click(function(){if(!$(this).hasClass("currentBranch")){var currentBranch=$(this).text();window.location.replace(utilities.updateQueryStringParameter(window.location.href,"branch",currentBranch))}});$("#mobileMenu").on("affixed.bs.affix",function(){$("#mobileMenuSpaceHolder").addClass("menubarAffixed")}).on("affixed-top.bs.affix",function(){$("#mobileMenuSpaceHolder").removeClass("menubarAffixed")});$("#breadcrumbTablet #isdShare, #tabletContainerWithoutBreadcrumbs #isdShare").length>0&&$("#breadcrumbTablet #isdShare, #tabletContainerWithoutBreadcrumbs #isdShare").click(function(){$("#mobileSocialShare #socials").length>0&&$("#mobileSocialShareModal").modal("show")})}$(document).ready(function(){init()})};typeof define=="function"&&window.mtpsAmd?define("OpenPublishingMobileMenu",["jquery","utilities"],function($,utilities){return OpenPublishingMobileMenuModule($,utilities)}):OpenPublishingMobileMenuModule($,window.epx.utilities)})();;
(function(){var apiRunnerModule=function($,telemetry){function init(){$timeout=$("#ajaxTimeout");showTheOpenPlaygroundButtons();showTheTryButtons();isIE9Compatible=document.documentMode!==undefined&&document.documentMode<10;isIE9Compatible&&jQuery.ajaxTransport(function(s){if(s.crossDomain&&s.async){s.timeout&&(s.xdrTimeout=s.timeout,delete s.timeout);var xdr;return{send:function(_,complete){function callback(status,statusText,responses,responseHeaders){xdr.onload=xdr.onerror=xdr.ontimeout=jQuery.noop;xdr=undefined;complete(status,statusText,responses,responseHeaders)}xdr=new XDomainRequest;xdr.onload=function(){callback(200,"OK",{text:xdr.responseText},"Content-Type: "+xdr.contentType)};xdr.onerror=function(){callback(404,"Not Found",{},"ApiExProxy-Error: 1")};xdr.onprogress=jQuery.noop;xdr.ontimeout=function(){callback(0,"timeout")};xdr.timeout=s.xdrTimeout||1e4;xdr.open(s.type,s.url);xdr.send(s.hasContent&&s.data||null)},abort:function(){xdr&&(xdr.onerror=jQuery.noop,xdr.abort())}}}})}function showTheOpenPlaygroundButtons(){var $playgroundUrl=$("input#playgroundUrl"),$supportedLanguagesForPlayground=$("input#supportedLanguagesForPlayground"),supportedLanguagesForPlayground;$playgroundUrl.length==1&&$playgroundUrl.val()!=""&&$supportedLanguagesForPlayground.length==1&&$supportedLanguagesForPlayground.val()!=""?(supportedLanguagesForPlayground=$supportedLanguagesForPlayground.val().toLowerCase().split(";"),$.each($("form.formToOpenPlayground"),function(index,element){var $language=$(element).find('input[name="Language"]');if($language.length==1&&$language.val().trim()&&$.inArray($language.val().trim().toLowerCase(),supportedLanguagesForPlayground)!=-1){$language.val().trim().toLowerCase()=="c#"&&$language.val("CSharp");$(element).attr("action",$playgroundUrl.val());$(element).show();$(element).on("submit",trackOpenPlayground)}else $(element).remove()})):$("form.formToOpenPlayground").remove()}function trackOpenPlayground(){return telemetry.trackEvent("OA-OpenPlayground",{URL:location.href}),!0}function showTheTryButtons(){var $proxyUrl=$("input#proxyUrl"),$authorizationHeaderInput=$("#authorizationHeader");if($proxyUrl.length!=1||$proxyUrl.val()==""||$authorizationHeaderInput.length!=1||$authorizationHeaderInput.val()==""){$(".tryItArea").remove();return}$.each($(".tryItArea"),function(index,element){var isAzureAPIEnabled=!1,result,$sendButton;$($(this).parent()).hasClass("operationDocs")&&(isAzureAPIEnabled=!0);result=validateTryAreas($(this),isAzureAPIEnabled);result!=null&&result.validate&&($sendButton=$('<button class="send">Try<\/button>'),result.apiDetails.append($sendButton),$sendButton.click(function(){clickSend(result,$proxyUrl.val(),$authorizationHeaderInput.val(),$(this),isAzureAPIEnabled)}))})}function validateTryAreas($tryArea,isAzureAPIEnabled){var $apiDetails=$tryArea.find("div.apiDetails"),urlToSend,$tableForParameters,urlHasParameters,$parent,$codeexample,$status,$requestToUpdate,$responseBodyToUpdate,$responseHeadersToUpdate,$responsesToHide,$responsesToShow,$contentTypeLinkToDisable,$headerResponseTab,$requestToUpdateDiv,$isInteractive,methodType;return $apiDetails.length!=1?($tryArea.remove(),{validate:!1}):(urlToSend=$apiDetails.find(".urlToSend").val(),!urlToSend.trim())?($tryArea.remove(),{validate:!1}):($tableForParameters=$apiDetails.find("table"),urlHasParameters=urlToSend.indexOf("{")!=-1&&urlToSend.indexOf("}")!=-1,urlHasParameters&&$tableForParameters.length<1)?($tryArea.remove(),{validate:!1}):($parent=$tryArea.parent(),!$parent.hasClass("sampleRequestAndResponseBlock"))?($tryArea.remove(),{validate:!1}):($codeexample=$parent.find("div.codeexample.response"),$codeexample.length!=1)?($tryArea.remove(),{validate:!1}):($status=$codeexample.find("span.status"),$status.length==0)?($tryArea.remove(),{validate:!1}):(isAzureAPIEnabled?($responseBodyToUpdate=$codeexample.find("div[data-interactive ='true'] div[id*='body'] > pre > code"),$responseHeadersToUpdate=$codeexample.find("div[data-interactive ='true'] div[id*='headers'] > pre > code"),$responsesToHide=$codeexample.find("div[data-interactive ='false'], li[data-interactive ='false']"),$responsesToShow=$codeexample.find("div[data-interactive ='true']"),$contentTypeLinkToDisable=$codeexample.find("li[data-interactive ='true']"),$headerResponseTab=$codeexample.find(".responseHeader"),$requestToUpdateDiv=$parent.find(".requestToUpdate"),urlHasParameters?($requestToUpdate=$requestToUpdateDiv.find("> pre > code.request"),updateSampleRequest($requestToUpdate,updateUrlToSend($tableForParameters.find("input"),urlToSend,!0))):$requestToUpdateDiv.remove()):($responseBodyToUpdate=$codeexample.find("pre > code"),$requestToUpdate=$parent.find("pre > code.request")),$responseBodyToUpdate.length!=1||!isAzureAPIEnabled&&$requestToUpdate.length!=1)?($tryArea.remove(),{validate:!1}):isAzureAPIEnabled&&($headerResponseTab.length==0||$responseHeadersToUpdate.length!=1||urlHasParameters&&!$requestToUpdate)?($tryArea.remove(),{validate:!1}):($apiDetails.css("display","inline-block"),isAzureAPIEnabled&&($isInteractive=$tryArea.find("input.isInteractive"),$isInteractive.length!=1||$isInteractive.val().toLowerCase()!="true"))?(disableEditableColumnsInParameterTable($tableForParameters),{validate:!1}):(methodType=getMethodType($apiDetails),methodType.toLowerCase()!="get")?(isAzureAPIEnabled?disableEditableColumnsInParameterTable($tableForParameters):$tryArea.remove(),{validate:!1}):{validate:!0,apiDetails:$apiDetails,urlToSend:urlToSend,requestToUpdate:$requestToUpdate,status:$status,responseBodyToUpdate:$responseBodyToUpdate,codeexample:$codeexample,responseHeadersToUpdate:$responseHeadersToUpdate,headerResponseTab:$headerResponseTab,responsesToHide:$responsesToHide,responsesToShow:$responsesToShow,contentTypeLinkToDisable:$contentTypeLinkToDisable}}function disableEditableColumnsInParameterTable($tableForParameters){if($tableForParameters&&$tableForParameters.length==1){var $editableCells=$tableForParameters.find("td.default");$editableCells.each(function(){var $input=$($(this).find("input")),$span=$("<p><\/p>");$span.text($input.val());$input.remove();$(this).append($span);$(this).addClass("disabled")})}}function clickSend(result,proxyUrl,authorizationHeader,$button,isAzureAPIEnabled){var $requiredinputs=result.apiDetails.find("table input"),urlToSend=updateUrlToSend($requiredinputs,result.urlToSend,!1),requestHeaders=getRequestHeaders(result.apiDetails,authorizationHeader,getResourceName(urlToSend)),methodType=getMethodType(result.apiDetails),requestBody=getRequestBody(result.apiDetails),$link,contentType;updateSampleRequest(result.requestToUpdate,updateUrlToSend($requiredinputs,result.urlToSend,!0));urlToSend=proxyUrl+"?url="+encodeURIComponent(urlToSend);result.responsesToHide&&result.responsesToHide.length>0&&result.responsesToHide.remove();isAzureAPIEnabled&&!result.responsesToShow.hasClass("active")&&result.responsesToShow.addClass("active");result.contentTypeLinkToDisable&&result.contentTypeLinkToDisable.length==1&&($link=result.contentTypeLinkToDisable.find("a"),$link.length==1&&(contentType=$link.text(),$link.remove(),result.contentTypeLinkToDisable.text(contentType),result.contentTypeLinkToDisable=null));result.status.text("");result.responseBodyToUpdate.text("");isAzureAPIEnabled&&result.responseHeadersToUpdate.text("");telemetry.trackEvent("OA-API-Try-Reqest",{URLTemplate:result.urlToSend,URL:urlToSend});makeAJAXcall(urlToSend,requestHeaders,methodType,requestBody,result,$button,isAzureAPIEnabled)}function getRequestHeaders($apiDetails,authorizationHeader,resourceName){var $requestHeadersInput=$apiDetails.find(".requestHeaders"),requestHeaders=JSON.parse("{}");return $requestHeadersInput.length==1&&$requestHeadersInput.val().trim()&&(requestHeaders=JSON.parse($requestHeadersInput.val())),requestHeaders.Accept||(requestHeaders.Accept="application/json"),requestHeaders.Authorization=authorizationHeader.replace("{resourceName}",resourceName),requestHeaders["ApiExProxy-FixedAadUser"]="1",requestHeaders}function getMethodType($apiDetails){var $methodInput=$apiDetails.find(".methodType"),methodType="GET";return $methodInput.length==1&&$methodInput.val().trim()&&(methodType=$methodInput.val()),methodType}function getRequestBody($apiDetails){var $requestBodyHiddenInput=$apiDetails.find("input.requestBody");return $requestBodyHiddenInput.length==1&&$requestBodyHiddenInput.val().trim()?$requestBodyHiddenInput.val():""}function updateUrlToSend($requiredinputs,requestFormat,encodeParam){return $.each($requiredinputs,function(index,element){var classAttr=$(element).attr("class");if(classAttr){requestFormat=replacePlaceholderInUrl(requestFormat,"{"+classAttr+"}",encodeParam?encodeURIComponent($(element).val()):$(element).val());return}var dataparam=$(element).attr("data-param"),isQuery=$(element).attr("data-isqueryparam"),paramValue=$(element).val();encodeParam&&(paramValue=encodeURIComponent($(element).val()));requestFormat=requestFormat.replace("{"+dataparam+"}",paramValue);isQuery=="true"&&(requestFormat=requestFormat.replace(dataparam,dataparam+"="+paramValue))}),requestFormat=requestFormat.replace("[","").replace("]","")}function replacePlaceholderInUrl(urlToSend,placeholder,value){if(value===null||value===undefined||value===""){var regex=new RegExp("([\\?|&])[\\w|-|_|\\$]+?="+placeholder+"&?");if(urlToSend.match(regex))return urlToSend.replace(regex,"$1").replace(/[\?|&]$/,"")}return urlToSend.replace(placeholder,value)}function updateSampleRequest($request,urlToSend){if($request&&$request.length==1){var $spanForVerb=$request.find("span.label"),$spanForRequest=$("<span>"+urlToSend+"<\/span>");$request.text("");$request.append($spanForVerb);$request.append(" ");$request.append($spanForRequest)}}function getResourceName(url){var arr=url.split("/");return arr.length<3||arr[1].trim()||!arr[0].trim()?"":arr[0]+"//"+arr[2]+"/"}function getHeadersAsQueryParams(requestHeaders){var queryParams="",header;for(header in requestHeaders)requestHeaders.hasOwnProperty(header)&&(queryParams+="&hdr."+header+"="+encodeURIComponent(requestHeaders[header]));return queryParams}function makeAJAXcall(urlToSend,requestHeaders,methodType,requestBody,result,$button,isAzureAPIEnabled){result.responseBodyToUpdate.addClass("loading");isAzureAPIEnabled&&result.responseHeadersToUpdate.addClass("loading");$button.prop("disabled",!0).css("cursor","default");isIE9Compatible&&(urlToSend.indexOf("https:")==0&&window.location.protocol!="https:"&&(urlToSend="http"+urlToSend.substring(5)),urlToSend+=getHeadersAsQueryParams(requestHeaders));var errorPayload={URLTemplate:result.urlToSend,URL:urlToSend},errorFlag=!1;$.ajax({url:urlToSend,type:methodType,data:requestBody,timeout:$timeout.val(),headers:requestHeaders,success:function(data,textStatus,xhr){updateResponse(result,data,!0);result.status.text(xhr.status)},error:function(jqXHR,exception){var errorHeader,jsonResponseText;if(errorFlag=!0,errorPayload.StatusText=jqXHR.statusText,errorPayload.Status=jqXHR.status,exception==="timeout"){errorPayload.ErrorType="Timeout";updateResponse(result,friendlyError,!1);result.status.text("");return}if(errorHeader=jqXHR.getResponseHeader("ApiExProxy-Error"),jqXHR.status=="0"||errorHeader!=null&&errorHeader!="0")errorPayload.ErrorType="Proxy",updateResponse(result,friendlyError,!1),result.status.text("");else try{errorPayload.ErrorType="Service";jsonResponseText=$.parseJSON(jqXHR.responseText);updateResponse(result,jsonResponseText,!0);result.status.text(jqXHR.status)}catch(error){errorPayload.ErrorType="Unexpected";updateResponse(result,friendlyError,!1);result.status.text("")}},complete:function(xhr){errorFlag&&telemetry.trackEvent("OA-API-Try-Error",errorPayload);result.responseBodyToUpdate.removeClass("loading");isAzureAPIEnabled&&xhr.getAllResponseHeaders()!=null&&($(result.headerResponseTab).css("display","inline-block"),result.responseHeadersToUpdate.removeClass("loading"),$(result.responseHeadersToUpdate).text(xhr.getAllResponseHeaders()).change());$button.prop("disabled",!1).css("cursor","pointer")}})}function updateResponse(result,data,jsonFormatting){jsonFormatting?$(result.responseBodyToUpdate).text(JSON.stringify(data,null,4)).change():$(result.responseBodyToUpdate).text(data).change()}var $timeout,friendlyError="Oops, our 'Try' feature is still in preview, and doesn’t seem to be working right now. Clippy gave us 503 suggestions to try, and the best one is to please try again later.",isIE9Compatible;return $(document).ready(function(){init()}),{validateTryAreas:validateTryAreas,getRequestBody:getRequestBody,getRequestHeaders:getRequestHeaders,getMethodType:getMethodType,getResourceName:getResourceName,updateUrlToSend:updateUrlToSend,updateSampleRequest:updateSampleRequest,clickSend:clickSend,showTheOpenPlaygroundButtons:showTheOpenPlaygroundButtons,showTheTryButtons:showTheTryButtons,getHeadersAsQueryParams:getHeadersAsQueryParams,init:init}};typeof define=="function"&&window.mtpsAmd?define("apiRunner",["jquery","telemetry"],function($,telemetry){return apiRunnerModule($,telemetry)}):(window.epx=window.epx||{},window.epx.apiRunnerModule=apiRunnerModule($,window.epx.telemetry))})();;
(function(){var openPublishingTopicModule=function(w,d,$,utilities){var expandNodeTooltip=$("#ExpandLocalizeString").text().trim(),collapseNodeTooltip=$("#CollapseLocalizeString").text().trim();$("#tocNav a.tocCollapsed").each(function(){$(this).attr("label",expandNodeTooltip)});$("#tocNav a.tocExpanded").each(function(){$(this).attr("label",collapseNodeTooltip)});$(d).ready(function(){var title,canonicalUrl,canonicalMeta,gitHubUrl,moreContributorsLink;$(".main #task-nav-list").appendTo($(".right div#right-nav-area"));$(".main #right-nav-wrapper").remove();$("#API").removeClass("row");$("#api-doc-contents").removeClass("col-md-9");$("#right-nav-wrapper").removeClass("col-md-3");$("#tocNav, #tocDropdownMenu").on("click","a.tocExpanded, a.tocCollapsed",function(){var childrenToc=$(this).parent().next();return childrenToc.length<1?!1:($(this).toggleClass("tocExpanded tocCollapsed"),$(childrenToc[0]).toggleClass("hidden"),$(this).hasClass("tocCollapsed")?$(this).attr("label",expandNodeTooltip):$(this).attr("label",collapseNodeTooltip),!1)});$("#tocNav").on("click","a.tocContainer",function(){var childrenToc=$(this).parent().next(),prev;return childrenToc.length<1?!1:(prev=$(this).prev(),prev.toggleClass("tocExpanded tocCollapsed"),$(childrenToc[0]).toggleClass("hidden"),prev.hasClass("tocCollapsed")?prev.attr("label",expandNodeTooltip):prev.attr("label",collapseNodeTooltip),!1)});$("#tocNav").on("click","a.tocRoot, a.tocRootIcon",function(){var tocData=$(this).parent().parent().find("div.tocData");return tocData.length<1?!1:($(tocData[0]).toggleClass("hidden"),!1)});title=encodeURIComponent($("title").text());canonicalMeta=$("link[rel='canonical']");canonicalUrl=canonicalMeta.length>0?encodeURIComponent(canonicalMeta.attr("href")):encodeURIComponent(w.location.href);var facebookShareUrl="https://www.facebook.com/sharer/sharer.php?u="+canonicalUrl,twitterShareUrl="https://twitter.com/intent/tweet?original_referer="+canonicalUrl+"&text="+title+"&tw_p=tweetbutton&url="+canonicalUrl,googlePlusShareUrl="https://plus.google.com/share?url="+canonicalUrl;$(".isdFacebook").attr("href",facebookShareUrl);$(".isdTwitter").attr("href",twitterShareUrl);$(".isdGooglePlus").attr("href",googlePlusShareUrl);$("#right-nav-area #isdShare").on("click",function(){return $("#right-nav-area #socials").toggle(),!1});$("body").not("#right-nav-area #socials").click(function(){$("#right-nav-area #socials").hide()});$("#socials > a").on("click",function(){return w.open(this.href,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600"),!1});if($("#tabletContainerWithoutBreadcrumbs #currentOPBranch, #right-nav-area #currentOPBranch").change(function(){var currentBranch=this.value;w.location.replace(utilities.updateQueryStringParameter(w.location.href,"branch",currentBranch))}),$("#tocMenuToggler").click(function(){$("#body").toggleClass("tocCollapsed")}),$("#contributorList").length==1){var gitContributorsRightOffset=$(".gitContributors").offset().left+$(".gitContributors").width(),contributorsLabelRightOffset=$("#contributorList .contributorsLabel").offset().left+$("#contributorList .contributorsLabel").width(),availableSpaceForContributorList=gitContributorsRightOffset-contributorsLabelRightOffset-10,maxContributorsCount=availableSpaceForContributorList/31-1,existingContributorsCount=$("#contributorList li").length;existingContributorsCount>maxContributorsCount&&($("#contributorList li:lt("+maxContributorsCount+")").show(),$("#contributorList li").not(":lt("+maxContributorsCount+")").hide(),gitHubUrl=$("#isdContribute").attr("href"),moreContributorsLink=$("<li><a target='_blank' class='moreContributors' href='"+gitHubUrl+"' aria-label='View more'>...<\/a><\/li>"),moreContributorsLink.appendTo("#contributorList ul"))}$("div.NOTE, div.WARNING, div.TIP, div.IMPORTANT, div.CAUTION").each(function(){var originalClass=$(this).attr("class").split(" ")[0].toLowerCase();$(this).removeClass().addClass("alert").addClass("alert-"+originalClass);$(this).find("h5").prepend($("<span/>").addClass("icon-"+originalClass))});$("div.main span > div.gitContributors").length>0?insertNextInPageNavigation($("div.main span > div.gitContributors").parent()):$("div.main h1").length>0&&insertNextInPageNavigation($("div.main h1").first())})},insertNextInPageNavigation=function($precedingElem){$insertElem=$("<div>").attr("id","movileInPageNav");$("ul#task-nav-list").clone().appendTo($insertElem);$insertElem.find("#task-nav-list").attr("id","mobile-task-nav-list").removeClass();$insertElem.find("li.nav-header").click(function(){$(this).parent().toggleClass("showMobileInPageNav")});$precedingElem.after($insertElem)};typeof define=="function"&&window.mtpsAmd?define("openPublishingTopic",["jquery","utilities"],function($,utilities){openPublishingTopicModule(window,document,$,utilities)}):(window.epx=window.epx||{},openPublishingTopicModule(window,document,$,window.epx.utilities))})();;
(function(){var apiModule=function($){function initConstants(){$container=$("#API");$container.length<1&&($container=$("#threeColumns"));$header=$("#ux-header");$uhfHeader=$("#uhf-header-wrapper");$content=$("#content");$footer=$("#ux-footer");$leftNav=$("#leftNavigation");$rightNav=$("#right-nav-area");$breadcrumbs=$("#TocNavigation_Breadcrumbs_WithDropDowns");$openfeedbackContainer=$("#openFeedbackContainer");$header.length==1&&(headerHeight=$header.height(),isSticky($header)?(rightNavScrollSpyOffset+=$header.height(),rightNavFixTopOffset+=$header.height()):rightNavAffixTopOffset+=$header.height());$uhfHeader.length==1&&(headerHeight=$uhfHeader.height(),isSticky($uhfHeader)?(rightNavScrollSpyOffset+=$uhfHeader.height(),rightNavFixTopOffset+=$uhfHeader.height()):rightNavAffixTopOffset+=$uhfHeader.height());$content.length==1&&$content.offset()&&(rightNavScrollSpyOffset+=$content.offset().top,rightNavFixTopOffset+=$content.offset().top);$breadcrumbs.length==1&&(isSticky($breadcrumbs)?(rightNavScrollSpyOffset+=$breadcrumbs.outerHeight(!0),rightNavFixTopOffset+=$breadcrumbs.outerHeight(!0)):rightNavAffixTopOffset+=$breadcrumbs.height(),$footer.length==1&&isSticky($breadcrumbs)&&$(window).scroll(function(){$(window).scrollTop()<$footer.offset().top-$breadcrumbs.outerHeight(!0)-headerHeight?$breadcrumbs.show():$breadcrumbs.hide()}))}function getRightNavAffixBottomOffset(){var rightNavAffixBottomOffset=10;return $footer.length==1&&(rightNavAffixBottomOffset+=$footer.height()),$openfeedbackContainer.length==1&&(rightNavAffixBottomOffset+=$openfeedbackContainer.height()),rightNavAffixBottomOffset+parseInt($container.parent().css("margin-bottom"))}function isSticky($elem){return $elem.css("position")=="fixed"||$elem.css("position")=="absolute"}function enableScrollSpy(){$body.scrollspy({target:$rightNav.selector,offset:rightNavScrollSpyOffset});$("a.expandCollapseButton, code.collapsed").click(function(){$body.scrollspy("refresh")})}function enableAffix(){$rightNav.affix({offset:{top:rightNavAffixTopOffset,bottom:getRightNavAffixBottomOffset}}).on("affixed-top.bs.affix",function(){$(this).css("position","relative");$(this).css("top",0)}).on("affixed.bs.affix",function(){$(this).css("position","fixed");$(this).css("top",rightNavFixTopOffset)}).on("affixed-bottom.bs.affix",function(){$(this).css("position","absolute")});if($rightNav.affix("checkPosition"),$leftNav!=null){$leftNav.css("position","relative");$leftNav.affix({offset:{top:rightNavAffixTopOffset,bottom:getRightNavAffixBottomOffset}}).on("affixed-top.bs.affix",function(){$(this).css("position","relative");$(this).css("top",0)}).on("affixed.bs.affix",function(){$("#leftNavigation").height()<$("div.main").height()&&($(this).css("position","fixed"),$(this).css("top",rightNavFixTopOffset))}).on("affixed-bottom.bs.affix",function(){$("#leftNavigation").height()<$("div.main").height()&&$(this).css("position","absolute")});$leftNav.affix("checkPosition")}}var $body=$("body"),$container,$header,$uhfHeader,$content,$footer,$leftNav,$rightNav,$breadcrumbs,$openfeedbackContainer,headerHeight=0,rightNavScrollSpyOffset=10,rightNavAffixTopOffset=0,rightNavFixTopOffset=10;$(document).ready(function(){initConstants();enableScrollSpy();enableAffix();$(window.location.hash)&&$(window.location.hash).offset()&&$(window).scrollTop($(window.location.hash).offset().top)})};typeof define=="function"&&window.mtpsAmd?define("api",["jquery","bootstrapJs"],function($){return apiModule($)}):apiModule($)})();;
