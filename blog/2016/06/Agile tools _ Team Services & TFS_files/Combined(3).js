(function(){var ratingModule=function($,utilities){function initWedcs(){$("#ratingYes").bind("click",function(){utilities.isdefined("MscomCustomEvent")&&MscomCustomEvent("ms.title=yes","ms.cmpgrp=feedbackform")});$("#ratingNo").bind("click",function(){utilities.isdefined("MscomCustomEvent")&&MscomCustomEvent("ms.title=no","ms.cmpgrp=feedbackform")});$("#ratingSubmit").bind("click",function(){if(utilities.isdefined("MscomCustomEvent")){var feedbackCharacterCount=Number($("#ratingText").attr("maxLength"))-Number($("#feedbackTextCounter").text());MscomCustomEvent("ms.title=submit","ms.feedbackid="+feedbackCharacterCount,"ms.cmpgrp=feedbackform")}});$("#ratingSkipThis").bind("click",function(){utilities.isdefined("MscomCustomEvent")&&MscomCustomEvent("ms.title=skip this","ms.cmpgrp=feedbackform")})}function toggleRatingEnablement(){$("#isTopicRated").val()==="true"&&showSection($thankYouSection)}function setupEventHandlers(){$("#ux-footer #ratingYes").click(function(){$("#ux-footer #ratingValue").val(yesRating);showSection($submitSection);$("#ux-footer #ratingText").focus()});$("#ux-footer #ratingNo").click(function(){$("#ux-footer #ratingValue").val(noRating);showSection($submitSection);$("#ux-footer #ratingText").focus()});$submitButton.click(function(){submitRating($("#ux-footer div.rating textarea").val())});$skipThisButton.click(function(){submitRating(null)});var maxChars=$("#feedbackTextCounter").text();maxChars||(maxChars=1500);$("#ratingText").on("keyup blur keydown",function(){textBoxCharactersCounter($(this),$("#feedbackTextCounter"),maxChars)})}function showSection($section){$yesNoSection.hide();$submitSection.hide();$thankYouSection.hide();$section.show();$section===$thankYouSection&&($("#rateThisTopic").hide(),$("#rateThisPrefix").hide())}function submitRating(text){$submitButton.attr("disabled","disabled");$skipThisButton.attr("disabled","disabled");var data={__RequestVerificationToken:$("input[name='__RequestVerificationToken']").last().val(),rdIsUseful:$("#ux-footer #ratingValue").val(),feedbackText:text,onePubTopicId:$("#onePubTopicId").val(),returnUrl:window.location.href,isAsync:!0},url=$("#ratingSubmitUrl").val();$.ajax({type:"POST",url:url,data:data,async:!0,success:function(){epx.utilities.log("Rating successfully submitted");showSection($thankYouSection)},error:function(response){epx.utilities.log("Rating submission failed: HTTP "+response.status);showSection($thankYouSection)}})}function textBoxCharactersCounter(control,counter,max){control.val().length>max?control.val(control.val().substring(0,max)):counter.html((max-control.val().length).toString())}var yesRating=1,noRating=0,$yesNoSection,$submitSection,$thankYouSection,$submitButton,$skipThisButton;$(document).ready(function(){($("#tocnav>div.current.archive").length==1&&$("#footerSock").hide(),$("#ux-footer #footerSock div.rating:visible").length!=0)&&($yesNoSection=$("#ux-footer #ratingSection1"),$submitSection=$("#ux-footer #ratingSection2"),$thankYouSection=$("#ux-footer #ratingSection3"),$submitButton=$("#ux-footer #ratingSubmit"),$skipThisButton=$("#ux-footer #ratingSkipThis"),toggleRatingEnablement(),setupEventHandlers(),initWedcs())})};typeof define=="function"&&window.mtpsAmd?define("rating",["jquery","utilities"],function($,utilities){return ratingModule($,utilities)}):(window.epx=window.epx||{},window.epx.windowsRating=ratingModule($,window.epx.utilities))})();;
epx=window.epx||{};epx.library=window.epx.library||{};epx.library.responsive=function(){function SwitchToDesktopView(){GetTocNavReady(currentViewType)}function SwitchToTabletViewLarge(){GetTocNavReady(currentViewType)}function SwitchToTabletViewSmall(){GetTocNavReady(currentViewType)}function SwitchToMobileView(){GetTocNavReady(currentViewType);$("#exportToolBar").length>0&&MTPS.Export.closeToolBar()}function GetTocNavReady(mode){mode==viewTypes.Desktop?($("#tocnav").appendTo("#leftNav"),epx.library.tocFixed!=undefined&&epx.library.tocFixed!=null&&epx.library.tocFixed.setPosition()):mode==viewTypes.TabletLarge||mode==viewTypes.TabletSmall?$("#tocnav").appendTo("#tocDropDownMenu"):mode==viewTypes.Mobile&&$("#tocnav").appendTo("#tocPopupMenu")}function resize(){epx.library&&epx.library.breadcrumbs&&epx.library.breadcrumbs.HideBreadcrumbDropDown();$("#tabletView_large").css("display")=="none"&&$("#tabletView_small").css("display")=="none"&&$("#mobileView").css("display")=="none"&&currentViewType!=viewTypes.Desktop?(currentViewType=viewTypes.Desktop,SwitchToDesktopView()):$("#tabletView_large").css("display")=="inline"&&currentViewType!=viewTypes.TabletLarge?(currentViewType=viewTypes.TabletLarge,SwitchToTabletViewLarge()):$("#tabletView_small").css("display")=="inline"&&currentViewType!=viewTypes.TabletSmall?(currentViewType=viewTypes.TabletSmall,SwitchToTabletViewSmall()):$("#mobileView").css("display")=="inline"&&currentViewType!=viewTypes.Mobile&&(currentViewType=viewTypes.Mobile,SwitchToMobileView())}function getCurrentViewType(){return currentViewType}function adjustContentTable(){$("#content table").filter(":not(.MTPSTranslatorTable)").wrap('<div class="contentTableWrapper"><\/div>')}var viewTypes={Desktop:0,TabletLarge:1,TabletSmall:2,Mobile:3},currentViewType=viewTypes.Desktop;return{resize:resize,getCurrentViewType:getCurrentViewType,viewTypes:viewTypes,adjustContentTable:adjustContentTable}}();$(document).ready(function(){$(window).resize(function(){windowWidth&&windowWidth!=$(window).width()&&(epx.library.responsive.resize(),windowWidth=$(window).width())});epx.library.responsive.resize();windowWidth=$(window).width();epx.library.responsive.adjustContentTable()});;
