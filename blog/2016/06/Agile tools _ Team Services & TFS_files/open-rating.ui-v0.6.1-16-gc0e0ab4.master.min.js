var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},OpenFeedback;!function(a){var b=function(){function a(){}return Object.defineProperty(a,"Instance",{get:function(){return null},enumerable:!0,configurable:!0}),a}();a.Void=b;var c=function(){function a(){this.supportLogInfo=a.checkConsoleLogFunction("info"),this.supportLogWarn=a.checkConsoleLogFunction("warn"),this.supportLogError=a.checkConsoleLogFunction("error")}return Object.defineProperty(a,"Instance",{get:function(){return null===a._instance&&(a._instance=new a),a._instance},enumerable:!0,configurable:!0}),a.checkConsoleLogFunction=function(a){return window.console&&"object"==typeof window.console&&"function"==typeof window.console[a]},a.prototype.logInfo=function(a){this.supportLogInfo&&window.console.info(a)},a.prototype.logWarning=function(a){this.supportLogWarn&&window.console.warn(a)},a.prototype.logError=function(a){this.supportLogError&&window.console.error(a)},a._instance=null,a}();a.Logger=c}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._cookiesMap=null}return Object.defineProperty(b.prototype,"cookiesMap",{get:function(){if(null===this._cookiesMap){this._cookiesMap={};for(var a=document.cookie.split(";"),b=0,c=a;b<c.length;b++){var d=c[b],e=d.indexOf("=");if(e>0){var f=d.substring(0,e),g=d.substr(e+1);this._cookiesMap[f.trim()]=g.trim()}}}return this._cookiesMap},enumerable:!0,configurable:!0}),b.prototype.retrieveCookie=function(b){return null==b?null:(this.cookiesMap[b]||a.Logger.Instance.logWarning("JY1601071438@"+b),this.cookiesMap[b]||null)},b.prototype.addCookie=function(b,c,d,e){void 0===d&&(d=null),void 0===e&&(e="/"),b&&c||a.Logger.Instance.logError("JY1601071432"),document.cookie=b+"="+c+(";path="+e)+(d?";expires="+d.toUTCString():""),this.cookiesMap[b]=c},b.prototype.removeCookie=function(b){b||a.Logger.Instance.logError("JY1601071434"),document.cookie=b+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT",delete this.cookiesMap[b]},b}();a.CookieHelper=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function a(){}return a.createEvent=function(a){var b=document.createEvent("Event");return b.initEvent(a,!0,!0),b},Object.defineProperty(a,"OpenFeedbackLayoutChangedEvent",{get:function(){return a.openFeedbackLayoutChangedEvent||(a.openFeedbackLayoutChangedEvent=a.createEvent("ofb-layoutchanged")),a.openFeedbackLayoutChangedEvent},enumerable:!0,configurable:!0}),a.fireEventAt=function(a,b){a.dispatchEvent(b)},a.openFeedbackLayoutChangedEvent=null,a}();a.EventHelper=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._cookie=new a.CookieHelper}return b.prototype.reload=function(){return this._cookie.retrieveCookie(b.CookieName)===b.CookieValue},b.prototype.persist=function(a){a?this._cookie.addCookie(b.CookieName,b.CookieValue):this._cookie.removeCookie(b.CookieName)},b.CookieName="openFeedbackIsHidden",b.CookieValue="true",b}();a.ExpandStateManager=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){function b(a){return new f(a)}function c(a,b){return new g(a,b)}var d=function(){function b(){this._result=null,this._isCompleted=!1,this._completeAction=null,this._continuationTask=null}return Object.defineProperty(b.prototype,"isCompleted",{get:function(){return this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isRunning",{get:function(){return!this.isCompleted},enumerable:!0,configurable:!0}),b.prototype.invokeContinuation=function(){this._continuationTask?this._continuationTask.invokeContinuationFunc(this._result):this._completeAction&&this._completeAction(this._result)},b.prototype.setResult=function(b){this.isRunning||a.Logger.Instance.logError("JY1512141523"),this._isCompleted=!0,this._result=b,this.invokeContinuation()},b.prototype.checkCallback=function(b){b||a.Logger.Instance.logError("JY1512141525!1"),null!==this._completeAction&&a.Logger.Instance.logWarning("JY1512141525!2"),null!==this._continuationTask&&a.Logger.Instance.logWarning("JY1512141525!3")},b.prototype.continueWith=function(a){this.checkCallback(a);var b=new e(a);return this._completeAction=null,this._continuationTask=b,this.isRunning||this.invokeContinuation(),b},b.prototype.completeWith=function(a){this.checkCallback(a),this._continuationTask=null,this._completeAction=a,this.isRunning||this.invokeContinuation()},b}();a.Task=d;var e=function(b){function c(a){b.call(this),this._continuationFunc=a}return __extends(c,b),c.prototype.invokeContinuationFunc=function(c){var d=this,e=this._continuationFunc(c);e||a.Logger.Instance.logError("JY1512141533"),e.completeWith(function(a){b.prototype.setResult.call(d,a)})},c}(d);a.TaskFromResult=b;var f=function(a){function b(b){a.call(this),a.prototype.setResult.call(this,b)}return __extends(b,a),b}(d);a.TaskWhenBoth=c;var g=function(a){function b(b,c){var d=this;a.call(this);var e,f,g=0,h=function(){2===++g&&a.prototype.setResult.call(d,[e,f])};b.completeWith(function(a){e=a,h()}),c.completeWith(function(a){f=a,h()})}return __extends(b,a),b}(d)}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){function b(){return window.openFeedbackOptions}a.getOpenFeedbackOptions=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._id=null}return b.prototype.generateId=function(){var a=("00000000"+Math.round(4294967296*Math.random()).toString(16)).substr(-8),b=("0000"+Math.round(65536*Math.random()).toString(16)).substr(-4),c=("0000"+Math.round(65536*Math.random()).toString(16)).substr(-4),d=("0000"+Math.round(65536*Math.random()).toString(16)).substr(-4),e=("000000000000"+(new Date).getTime().toString(16)).substr(-12);return a.concat(b,c,d,e)},b.prototype.retrieveOrGenerateId=function(){var b=a.getOpenFeedbackOptions().anonUserCookieName,c=new a.CookieHelper,d=c.retrieveCookie(b);if(d)return d;if(b="openFeedbackAnonUserId",d=c.retrieveCookie(b))return d;d=this.generateId();var e=new Date;return e.setUTCFullYear(e.getUTCFullYear()+1),c.addCookie(b,d,e),d},Object.defineProperty(b.prototype,"userId",{get:function(){return this._id||(this._id=this.retrieveOrGenerateId()),this._id},enumerable:!0,configurable:!0}),b}();a.UserManager=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function a(){this.width=window.innerWidth,this.height=window.innerHeight}return a}();a.UserWindowSize=b;var c=function(){function a(a){this._contract=a}return a.prototype.getContract=function(){return this._contract},a.createNew=function(c,d,e,f,g,h,i,j){return new a({anonUserId:c,documentId:d,documentSnapshotId:e||"openfeedback-anonysnap",locale:f,ratingTypeId:g,variantId:h,siteName:i,windowSize:new b,url:window.location.href,isSpam:!1,propertyBag:j&&"object"==typeof j?j:{}})},a.createUpdate=function(b,c){return new a({id:b,comment:c})},Object.defineProperty(a.prototype,"id",{get:function(){return this._contract.id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"typeId",{get:function(){return this._contract.ratingTypeId},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"insertedLocalTime",{get:function(){return this._contract.insertedUtcTime?new Date(this._contract.insertedUtcTime):null},enumerable:!0,configurable:!0}),a}();a.RatingItem=c;var d=function(){function b(b){void 0===b&&(b=null),this._backendUrl=b||a.getOpenFeedbackOptions().backendUrl}return b._convertNoContent=function(b){return a.Void.Instance},b._convertToRatingItem=function(a){return new c(a)},b._convertToRatingItemArray=function(a){return a.map(b._convertToRatingItem)},b.prototype.retrieveUserRatedItems=function(a,c,d,f){return new e(b._convertToRatingItemArray,"GET",this._backendUrl+"users/"+encodeURIComponent(a)+"/ratings?documentId="+encodeURIComponent(c)+"&documentSnapshotId="+(d?encodeURIComponent(d):"openfeedback-anonysnap")+"&locale="+encodeURIComponent(f))},b.prototype.addRatingItem=function(a){return new e(b._convertToRatingItem,"POST",this._backendUrl+"rating",a.getContract())},b.prototype.updateRatingItem=function(a){return new e(b._convertNoContent,"PUT",this._backendUrl+"rating/"+a.id,a.getContract())},b}();a.RatingService=d;var e=function(a){function b(b,c,d,e){var f=this;a.call(this);var g=new XMLHttpRequest;g.onreadystatechange=function(){if(g.readyState===g.DONE){var c=g.status;200!==c&&201!==c&&202!==c||!g.responseText?a.prototype.setResult.call(f,[c,null]):a.prototype.setResult.call(f,[c,b(JSON.parse(g.responseText))])}},g.open(c,d,!0),e&&g.setRequestHeader("Content-Type","application/json"),g.responseType="text",g.send(e?JSON.stringify(e):null)}return __extends(b,a),b}(a.Task);a.HttpRequest=e}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(c){if(this._locale=c,this._resource=null,c){this._locale=c.toLowerCase();var d=b.SupportedLocales.indexOf(this._locale);0>=d&&(0>d&&a.Logger.Instance.logWarning("JY1601281636@"+this._locale),this._locale=null)}}return b.prototype.convertToVoid=function(b){return this._resource=b,a.Void.Instance},b.prototype.loadResource=function(){var b=this;return this._locale?new a.HttpRequest(function(a){return b.convertToVoid(a)},"GET",""+a.getOpenFeedbackOptions().localizationUrl+this._locale+".json"):a.TaskFromResult(a.Void.Instance)},Object.defineProperty(b.prototype,"isAvailable",{get:function(){return!!this._resource},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isRtl",{get:function(){return this.isAvailable?this._resource.isRtl:!1},enumerable:!0,configurable:!0}),b.prototype.replaceText=function(a,b){this.isAvailable&&(a.textContent=this._resource.texts[b])},b.prototype.replaceNumberText=function(a,b,c,d,e,f){this.isAvailable?a.textContent=""+this._resource.texts[b]+c+this._resource.texts[d]:a.textContent=""+e+c+f},b.SupportedLocales=["en-us","ar-sa","bg-bg","cs-cz","da-dk","de-de","el-gr","es-es","et-ee","fi-fi","fil-ph","fr-fr","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","is-is","it-it","ja-jp","kk-kz","ko-kr","lt-lt","lv-lv","ms-my","nb-no","nl-nl","nn-no","pl-pl","pt-br","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sr-cyrl-cs","sr-latn-cs","sv-se","th-th","tr-tr","uk-ua","vi-vn","zh-cn","zh-hk","zh-tw"],b}();a.Localization=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._metadataMap=null}return Object.defineProperty(b.prototype,"metadataMap",{get:function(){if(null===this._metadataMap){this._metadataMap={};for(var a=document.getElementsByTagName("meta"),b=0;b<a.length;b++){var c=a[b],d=c.getAttribute("name");d&&(this._metadataMap[d.toLowerCase()]=c.getAttribute("content"))}}return this._metadataMap},enumerable:!0,configurable:!0}),b.prototype.retrieveMetadata=function(b){return this.metadataMap[b]||a.Logger.Instance.logWarning("JY1601261508@"+b),this.metadataMap[b]||null},b.prototype.retrieveDocumentId=function(){return this.retrieveMetadata(a.getOpenFeedbackOptions().documentMetaName.toLowerCase())},b.prototype.retrieveDocumentSnapshotId=function(){return this.retrieveMetadata(a.getOpenFeedbackOptions().documentSnapIdMetaName.toLowerCase())},b.prototype.retrieveUILocale=function(){var b=a.getOpenFeedbackOptions().uiLocale||this.retrieveLocale();return b.toLowerCase()},b.prototype.retrieveLocale=function(){return this.retrieveMetadata(a.getOpenFeedbackOptions().localeMetaName.toLowerCase())},b.prototype.retrieveSiteName=function(){return this.retrieveMetadata(a.getOpenFeedbackOptions().siteNameMetaName.toLowerCase())},b.prototype.retrieveVariantId=function(){return a.getOpenFeedbackOptions().variantId},b.prototype.retrievePropertyBag=function(){return a.getOpenFeedbackOptions().propertyBag},b}();a.MetadataHelper=b}(OpenFeedback||(OpenFeedback={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-vote"><div class="ofb-close"></div><div class="ofb-content"><span class="ofb-votetitle">Is this page helpful?</span><button class="ofb-yes" aria-label="Yes, this page is helpful">Yes</button><button class="ofb-no" aria-label="No, this page is not helpful">No</button></div></div>'}(b=a.vote||(a.vote={}))}(HtmlTemplates||(HtmlTemplates={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-feedback"><div class="ofb-close"></div><div class="ofb-form"><div class="ofb-fieldtitle">Additional feedback?</div><textarea class="ofb-detail" rows="6" maxlength="1500"></textarea><div><span class="ofb-charcnt">1500 characters remaining</span><div class="ofb-buttons"><button class="ofb-provide" aria-label="Submit my additional feedback">Submit</button><button class="ofb-skip" aria-label="Skip additional feedback">Skip this</button></div></div></div></div>'}(b=a.feedback||(a.feedback={}))}(HtmlTemplates||(HtmlTemplates={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-thanks"><div class="ofb-close"></div><div class="ofb-content"><div class="ofb-thankyou">Thank you!</div><div class="ofb-appreciate">We appreciate your feedback.</div></div></div>'}(b=a.thanks||(a.thanks={}))}(HtmlTemplates||(HtmlTemplates={}));var OpenFeedback;!function(a){function b(){return window}a.getCustomWEDCS=b;var c=function(){function b(){"function"==typeof window.MscomCustomEvent?this._instance=window:(a.Logger.Instance.logWarning("JY1601261509"),this._instance=null)}return Object.defineProperty(b.prototype,"isSupported",{get:function(){return!!this._instance},enumerable:!0,configurable:!0}),b.prototype.sendRatingItemTypeIdData=function(a,b,c){this.isSupported&&this._instance.MscomCustomEvent("wcs.cn="+a,"ms.rating="+c,"ms.feedbackid="+b,"ms.cmpgrp=feedbackform")},b.prototype.sendRatingItemData=function(a,b){this.isSupported&&this._instance.MscomCustomEvent("wcs.cn="+a,"ms.feedbackid="+b,"ms.cmpgrp=feedbackform")},b}();a.WedcsHelper=c}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._voteTask=null,this._feedbackTask=null}return b.prototype.vote=function(b){if(this._voteTask)return void a.Logger.Instance.logError("JY1601291831");var c=new a.UserManager,d=new a.MetadataHelper,e=new a.RatingService,f=new a.WedcsHelper;this._voteTask=e.addRatingItem(a.RatingItem.createNew(c.userId,d.retrieveDocumentId(),d.retrieveDocumentSnapshotId(),d.retrieveLocale(),b?1:0,d.retrieveVariantId(),d.retrieveSiteName(),d.retrievePropertyBag())).continueWith(function(c){var d=c[1];return d?(f.sendRatingItemTypeIdData(b?"yes":"no",d.id,d.typeId),a.TaskFromResult(d.id)):a.TaskFromResult(null)})},b.prototype.feedback=function(b,c){return this._voteTask?this._feedbackTask?void a.Logger.Instance.logError("JY1601291840"):void(this._feedbackTask=this._voteTask.continueWith(function(d){if(d){var e=new a.RatingService,f=new a.WedcsHelper;new a.MetadataHelper;return b?(f.sendRatingItemData("skip this",d),a.TaskFromResult(a.Void.Instance)):(f.sendRatingItemData("submit",d),c?e.updateRatingItem(a.RatingItem.createUpdate(d,c)).continueWith(function(b){return a.TaskFromResult(a.Void.Instance)}):a.TaskFromResult(a.Void.Instance))}return a.TaskFromResult(a.Void.Instance)})):void a.Logger.Instance.logError("JY1601291837")},b}();a.RatingWorkflow=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(c){var e=this;this._localization=c,this._isInSilent=!1,this._isFloated=null,this._workflow=new a.RatingWorkflow,this._stateManager=new a.ExpandStateManager,this._forbidFloat=this._stateManager.reload(),this._container=document.getElementById(a.getOpenFeedbackOptions().containerElementId),this._container.classList.add(b.ContainerCssClass),c.isRtl&&(this._container.dir="rtl"),this._page=new d(this),window.addEventListener("resize",function(){return e.refreshFloating()}),window.addEventListener("scroll",function(){return e.refreshFloating()}),a.EventHelper.fireEventAt(this._container,a.EventHelper.OpenFeedbackLayoutChangedEvent)}return Object.defineProperty(b.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"localization",{get:function(){return this._localization},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"workflow",{get:function(){return this._workflow},enumerable:!0,configurable:!0}),b.prototype.turnToPage=function(b){switch(this._page.containerCssClass&&this._container.classList.remove("ofb-child-"+this._page.containerCssClass),this._page.desctructor(),b){case 0:this._page=new d(this);break;case 1:this._page=new e(this);break;case 2:this._page=new f(this);break;case 3:this._page=new g(this)}this._page.containerCssClass&&this._container.classList.add("ofb-child-"+this._page.containerCssClass),a.EventHelper.fireEventAt(this._container,a.EventHelper.OpenFeedbackLayoutChangedEvent)},Object.defineProperty(b.prototype,"currentPage",{get:function(){return this._page.getPageType()},set:function(a){this._page.getPageType()!==a&&(this.turnToPage(a),this.refreshFloating())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isFloated",{get:function(){return this._isFloated},set:function(b){this._isFloated===b&&null!==this._isFloated||(this._isFloated=b,a.EventHelper.fireEventAt(this._container,a.EventHelper.OpenFeedbackLayoutChangedEvent))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"forbidFloat",{get:function(){return this._forbidFloat},set:function(a){this._forbidFloat!==a&&(this._forbidFloat=a,this.refreshFloating(),this._stateManager.persist(a))},enumerable:!0,configurable:!0}),b.prototype.refreshFloating=function(){if(this._page.root){var a=document.documentElement.clientHeight,c=this._container.getBoundingClientRect().top+this._page.root.clientHeight,d=c>=a;!d||0===this.currentPage||this._isInSilent||this.forbidFloat?(this._page.root.classList.remove(b.FloatCssClass),this._page.root.style.width="auto",this._isInSilent&&!d&&this.stopSilentTimeout(),this.isFloated=!1):(this._page.root.classList.add(b.FloatCssClass),this._page.root.style.width=this._container.clientWidth+"px",this.isFloated=!0)}},b.prototype.startSilentTimeout=function(){var a=this;this.stopSilentTimeout(),this._isInSilent=!0,this._timeoutId=window.setTimeout(function(){a._isInSilent=!1,a.refreshFloating()},1e4)},b.prototype.stopSilentTimeout=function(){this._isInSilent=!1,window.clearTimeout(this._timeoutId)},b.ContainerCssClass="ofb-container",b.FloatCssClass="ofb-float",b}();a.RatingControl=b;var c=function(){function a(b,c,d){if(this._rating=b,this._root=null,this._currentHeight=-1,b.container.innerHTML=c,d){this._root=b.container.getElementsByClassName(d)[0];var e=this._root.getElementsByClassName(a.CloseCssClass)[0];e.addEventListener("click",function(){return b.forbidFloat=!0})}}return a.prototype.desctructor=function(){this.disposeCore()},Object.defineProperty(a.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"containerCssClass",{get:function(){return null},enumerable:!0,configurable:!0}),a.CloseCssClass="ofb-close",a}(),d=function(a){function b(b){a.call(this,b,"",null)}return __extends(b,a),b.prototype.getPageType=function(){return 0},b.prototype.disposeCore=function(){},b}(c),e=function(a){function b(c){var d=this;a.call(this,c,HtmlTemplates.vote.html,b.VoteCssClass);var e=this.root.getElementsByClassName(b.TitleCssClass)[0],f=this.root.getElementsByClassName(b.YesCssClass)[0],g=this.root.getElementsByClassName(b.NoCssClass)[0];c.localization.replaceText(e,"vote_title"),c.localization.replaceText(f,"vote_yes"),c.localization.replaceText(g,"vote_no"),f.addEventListener("click",function(){return d.sendVote(!0)}),g.addEventListener("click",function(){return d.sendVote(!1)})}return __extends(b,a),b.prototype.disposeCore=function(){},b.prototype.getPageType=function(){return 1},Object.defineProperty(b.prototype,"containerCssClass",{get:function(){return"vote"},enumerable:!0,configurable:!0}),b.prototype.sendVote=function(a){this._rating.stopSilentTimeout(),this._rating.workflow.vote(a),this._rating.currentPage=2},b.VoteCssClass="ofb-vote",b.TitleCssClass="ofb-votetitle",b.YesCssClass="ofb-yes",b.NoCssClass="ofb-no",b}(c),f=function(a){function b(c){var d=this;a.call(this,c,HtmlTemplates.feedback.html,b.FeedbackCssClass);var e=this.root.getElementsByClassName(b.TitleCssClass)[0],f=this.root.getElementsByClassName(b.DetailCssClass)[0],g=this.root.getElementsByClassName(b.CharCntNumCssClass)[0],h=this.root.getElementsByClassName(b.ProvideCssClass)[0],i=this.root.getElementsByClassName(b.SkipCssClass)[0];c.localization.replaceText(e,"feedback_title"),c.localization.replaceText(h,"feedback_submit"),c.localization.replaceText(i,"feedback_skip"),h.addEventListener("click",function(){return d.sendDetails(!1,f.value)}),i.addEventListener("click",function(){return d.sendDetails(!0,f.value)}),f.addEventListener("change",function(){return d.refreshRemainChars(f,g)}),f.addEventListener("keyup",function(){return d.refreshRemainChars(f,g)}),f.addEventListener("paste",function(){return d.refreshRemainChars(f,g)}),f.addEventListener("input",function(){return d.refreshRemainChars(f,g)}),f.addEventListener("blur",function(){return d.refreshRemainChars(f,g)}),f.addEventListener("keydown",function(){return d.refreshRemainChars(f,g)}),this.refreshRemainChars(f,g)}return __extends(b,a),b.prototype.disposeCore=function(){},b.prototype.getPageType=function(){return 2},Object.defineProperty(b.prototype,"containerCssClass",{get:function(){return"feedback"},enumerable:!0,configurable:!0}),b.prototype.refreshRemainChars=function(a,b){var c=1500;this._rating.localization.replaceNumberText(b,"feedback_charcnt_before",c-a.value.length||0,"feedback_charcnt_after",""," characters remaining"),a.value.length>c&&(a.value=a.value.substring(0,c))},b.prototype.sendDetails=function(a,b){this._rating.stopSilentTimeout(),this._rating.workflow.feedback(a,b),this._rating.currentPage=3},b.FeedbackCssClass="ofb-feedback",b.TitleCssClass="ofb-fieldtitle",b.ProvideCssClass="ofb-provide",b.SkipCssClass="ofb-skip",b.DetailCssClass="ofb-detail",b.CharCntNumCssClass="ofb-charcnt",b}(c),g=function(a){function b(c){a.call(this,c,HtmlTemplates.thanks.html,b.ThanksCssClass);var d=this.root.getElementsByClassName(b.TitleCssClass)[0],e=this.root.getElementsByClassName(b.DetailCssClass)[0];c.localization.replaceText(d,"thanks_title"),c.localization.replaceText(e,"thanks_detail"),window.setTimeout(function(){c.stopSilentTimeout(),c.currentPage=0},5e3)}return __extends(b,a),b.prototype.disposeCore=function(){},b.prototype.getPageType=function(){return 3},Object.defineProperty(b.prototype,"containerCssClass",{get:function(){return"thanks"},enumerable:!0,configurable:!0}),b.ThanksCssClass="ofb-thanks",b.TitleCssClass="ofb-thankyou",b.DetailCssClass="ofb-appreciate",b}(c)}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=new a.MetadataHelper,c=new a.UserManager,d=new a.RatingService,e=new a.Localization(b.retrieveUILocale());a.TaskWhenBoth(e.loadResource(),d.retrieveUserRatedItems(c.userId,b.retrieveDocumentId(),b.retrieveDocumentSnapshotId(),b.retrieveLocale())).completeWith(function(b){var c=b[1][1],d=7776e6,f=(new Date).valueOf(),g=c&&c.every(function(a){return f-a.insertedLocalTime.valueOf()>d});if(g){var h=new a.RatingControl(e);h.startSilentTimeout(),h.currentPage=1}})}(OpenFeedback||(OpenFeedback={}));